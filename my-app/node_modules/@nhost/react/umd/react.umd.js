(function(_,L){typeof exports=="object"&&typeof module!="undefined"?L(exports,require("react"),require("react/jsx-runtime")):typeof define=="function"&&define.amd?define(["exports","react","react/jsx-runtime"],L):(_=typeof globalThis!="undefined"?globalThis:_||self,L(_["@nhost/react"]={},_.React,_._jsx))})(this,function(_,L,Mi){"use strict";function ji(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const r in t)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:()=>t[r]})}}return e.default=t,Object.freeze(e)}const Fi=ji(L);class ze extends Error{}ze.prototype.name="InvalidTokenError";function Vi(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Bi(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Vi(e)}catch{return atob(e)}}function zt(t,e){if(typeof t!="string")throw new ze("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new ze(`Invalid token specified: missing part #${r+1}`);let i;try{i=Bi(n)}catch(s){throw new ze(`Invalid token specified: invalid base64 for part #${r+1} (${s.message})`)}try{return JSON.parse(i)}catch(s){throw new ze(`Invalid token specified: invalid json for part #${r+1} (${s.message})`)}}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var T=function(){return T=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},T.apply(this,arguments)};function Jt(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function F(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function B(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(d){o={error:d}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function W(t,e,r){if(arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var q;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(q||(q={}));var xe;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(xe||(xe={}));var ht=q.Start,ft=q.Stop,Pe=q.Raise,Je=q.Send,Wt=q.Cancel,Kr=q.NullEvent,pt=q.Assign,Gi=q.After,Hi=q.DoneState,vt=q.Log,qr=q.Init,mt=q.Invoke,Yi=q.ErrorExecution,Qt=q.ErrorPlatform,Xt=q.ErrorCustom,yt=q.Update,$r=q.Choose,zr=q.Pure;const Ki=Object.freeze(Object.defineProperty({__proto__:null,after:Gi,assign:pt,cancel:Wt,choose:$r,doneState:Hi,error:Xt,errorExecution:Yi,errorPlatform:Qt,init:qr,invoke:mt,log:vt,nullEvent:Kr,pure:zr,raise:Pe,send:Je,start:ht,stop:ft,update:yt},Symbol.toStringTag,{value:"Module"}));var Jr=".",Wr={},Zt="xstate.guard",qi="",X=process.env.NODE_ENV==="production",gt;function er(t,e,r){r===void 0&&(r=Jr);var n=We(t,r),i=We(e,r);return H(i)?H(n)?i===n:!1:H(n)?n in i:Object.keys(n).every(function(s){return s in i?er(n[s],i[s]):!1})}function Qr(t){try{return H(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function tr(t,e){try{return Le(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function $i(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function We(t,e){if($i(t))return t.value;if(Le(t))return Et(t);if(typeof t!="string")return t;var r=tr(t,e);return Et(r)}function Et(t){if(t.length===1)return t[0];for(var e={},r=e,n=0;n<t.length-1;n++)n===t.length-2?r[t[n]]=t[n+1]:(r[t[n]]={},r=r[t[n]]);return e}function Qe(t,e){for(var r={},n=Object.keys(t),i=0;i<n.length;i++){var s=n[i];r[s]=e(t[s],s,t,i)}return r}function Xr(t,e,r){var n,i,s={};try{for(var o=F(Object.keys(t)),d=o.next();!d.done;d=o.next()){var u=d.value,l=t[u];r(l)&&(s[u]=e(l,u,t))}}catch(a){n={error:a}}finally{try{d&&!d.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}var zi=function(t){return function(e){var r,n,i=e;try{for(var s=F(t),o=s.next();!o.done;o=s.next()){var d=o.value;i=i[d]}}catch(u){r={error:u}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}};function Ji(t,e){return function(r){var n,i,s=r;try{for(var o=F(t),d=o.next();!d.done;d=o.next()){var u=d.value;s=s[e][u]}}catch(l){n={error:l}}finally{try{d&&!d.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}}function Tt(t){if(!t)return[[]];if(H(t))return[[t]];var e=Z(Object.keys(t).map(function(r){var n=t[r];return typeof n!="string"&&(!n||!Object.keys(n).length)?[[r]]:Tt(t[r]).map(function(i){return[r].concat(i)})}));return e}function Z(t){var e;return(e=[]).concat.apply(e,W([],B(t),!1))}function Zr(t){return Le(t)?t:[t]}function de(t){return t===void 0?[]:Zr(t)}function St(t,e,r){var n,i;if(G(t))return t(e,r.data);var s={};try{for(var o=F(Object.keys(t)),d=o.next();!d.done;d=o.next()){var u=d.value,l=t[u];G(l)?s[u]=l(e,r.data):s[u]=l}}catch(a){n={error:a}}finally{try{d&&!d.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}function Wi(t){return/^(done|error)\./.test(t)}function en(t){return!!(t instanceof Promise||t!==null&&(G(t)||typeof t=="object")&&G(t.then))}function Qi(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function Xi(t,e){var r,n,i=B([[],[]],2),s=i[0],o=i[1];try{for(var d=F(t),u=d.next();!u.done;u=d.next()){var l=u.value;e(l)?s.push(l):o.push(l)}}catch(a){r={error:a}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return[s,o]}function tn(t,e){return Qe(t.states,function(r,n){if(r){var i=(H(e)?void 0:e[n])||(r?r.current:void 0);if(i)return{current:i,states:tn(r,i)}}})}function Zi(t,e){return{current:e,states:tn(t,e)}}function rn(t,e,r,n){X||ie(!!t,"Attempting to update undefined context");var i=t&&r.reduce(function(s,o){var d,u,l=o.assignment,a={state:n,action:o,_event:e},c={};if(G(l))c=l(s,e.data,a);else try{for(var h=F(Object.keys(l)),f=h.next();!f.done;f=h.next()){var p=f.value,m=l[p];c[p]=G(m)?m(s,e.data,a):m}}catch(O){d={error:O}}finally{try{f&&!f.done&&(u=h.return)&&u.call(h)}finally{if(d)throw d.error}}return Object.assign({},s,c)},t);return i}var ie=function(){};X||(ie=function(t,e){var r=t instanceof Error?t:void 0;if(!(!r&&t)&&console!==void 0){var n=["Warning: ".concat(e)];r&&n.push(r),console.warn.apply(console,n)}});function Le(t){return Array.isArray(t)}function G(t){return typeof t=="function"}function H(t){return typeof t=="string"}function nn(t,e){if(t)return H(t)?{type:Zt,name:t,predicate:e?e[t]:void 0}:G(t)?{type:Zt,name:t.name,predicate:t}:t}function es(t){try{return"subscribe"in t&&G(t.subscribe)}catch{return!1}}var Ae=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();gt={},gt[Ae]=function(){return this},gt[Symbol.observable]=function(){return this};function Ee(t){return!!t&&"__xstatenode"in t}function ts(t){return!!t&&typeof t.send=="function"}var rs=function(){var t=0;return function(){return t++,t.toString(16)}}();function wt(t,e){return H(t)||typeof t=="number"?T({type:t},e):t}function ae(t,e){if(!H(t)&&"$$type"in t&&t.$$type==="scxml")return t;var r=wt(t);return T({name:r.type,data:r,$$type:"scxml",type:"external"},e)}function Ue(t,e){var r=Zr(e).map(function(n){return typeof n=="undefined"||typeof n=="string"||Ee(n)?{target:n,event:t}:T(T({},n),{event:t})});return r}function ns(t){if(!(t===void 0||t===qi))return de(t)}function is(t,e,r){if(!X){var n=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";if(t===e)console.error("Missing onError handler for invocation '".concat(r,"', error was '").concat(t,"'.").concat(n));else{var i=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(r,"'. ")+"Original error: '".concat(t,"'. ").concat(n," Current error is '").concat(e,"'.").concat(i))}}}function sn(t,e,r,n,i){var s=t.options.guards,o={state:i,cond:e,_event:n};if(e.type===Zt)return((s==null?void 0:s[e.name])||e.predicate)(r,n.data,o);var d=s==null?void 0:s[e.type];if(!d)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return d(r,n.data,o)}function on(t){return typeof t=="string"?{type:t}:t}function Xe(t,e,r){var n=function(){},i=typeof t=="object",s=i?t:null;return{next:((i?t.next:t)||n).bind(s),error:((i?t.error:e)||n).bind(s),complete:((i?t.complete:r)||n).bind(s)}}function xt(t,e){return"".concat(t,":invocation[").concat(e,"]")}function rr(t){return(t.type===Pe||t.type===Je&&t.to===xe.Internal)&&typeof t.delay!="number"}var Ne=ae({type:qr});function At(t,e){return e&&e[t]||void 0}function Me(t,e){var r;if(H(t)||typeof t=="number"){var n=At(t,e);G(n)?r={type:t,exec:n}:n?r=n:r={type:t,exec:void 0}}else if(G(t))r={type:t.name||t.toString(),exec:t};else{var n=At(t.type,e);if(G(n))r=T(T({},t),{exec:n});else if(n){var i=n.type||t.type;r=T(T(T({},n),t),{type:i})}else r=t}return r}var Te=function(t,e){if(!t)return[];var r=Le(t)?t:[t];return r.map(function(n){return Me(n,e)})};function Ot(t){var e=Me(t);return T(T({id:H(t)?t:e.id},e),{type:e.type})}function an(t,e){return{type:Pe,event:typeof t=="function"?t:wt(t),delay:e?e.delay:void 0,id:e==null?void 0:e.id}}function cn(t,e,r,n){var i={_event:r},s=ae(G(t.event)?t.event(e,r.data,i):t.event),o;if(H(t.delay)){var d=n&&n[t.delay];o=G(d)?d(e,r.data,i):d}else o=G(t.delay)?t.delay(e,r.data,i):t.delay;return T(T({},t),{type:Pe,_event:s,delay:o})}function Re(t,e){return{to:e?e.to:void 0,type:Je,event:G(t)?t:wt(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:G(t)?t.name:Qr(t)}}function un(t,e,r,n){var i={_event:r},s=ae(G(t.event)?t.event(e,r.data,i):t.event),o;if(H(t.delay)){var d=n&&n[t.delay];o=G(d)?d(e,r.data,i):d}else o=G(t.delay)?t.delay(e,r.data,i):t.delay;var u=G(t.to)?t.to(e,r.data,i):t.to;return T(T({},t),{to:u,_event:s,event:s.data,delay:o})}function nr(t,e){return Re(t,T(T({},e),{to:xe.Parent}))}function ss(t,e,r){return Re(e,T(T({},r),{to:t}))}function os(){return nr(yt)}function as(t,e){return Re(t,T(T({},e),{to:function(r,n,i){var s=i._event;return s.origin}}))}var cs=function(t,e){return{context:t,event:e}};function us(t,e){return t===void 0&&(t=cs),{type:vt,label:e,expr:t}}var ln=function(t,e,r){return T(T({},t),{value:H(t.expr)?t.expr:t.expr(e,r.data,{_event:r})})},dn=function(t){return{type:Wt,sendId:t}};function hn(t){var e=Ot(t);return{type:q.Start,activity:e,exec:void 0}}function fn(t){var e=G(t)?t:Ot(t);return{type:q.Stop,activity:e,exec:void 0}}function pn(t,e,r){var n=G(t.activity)?t.activity(e,r.data):t.activity,i=typeof n=="string"?{id:n}:n,s={type:q.Stop,activity:i};return s}var vn=function(t){return{type:pt,assignment:t}};function ls(t){return typeof t=="object"&&"type"in t}function mn(t,e){var r=e?"#".concat(e):"";return"".concat(q.After,"(").concat(t,")").concat(r)}function Ze(t,e){var r="".concat(q.DoneState,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function et(t,e){var r="".concat(q.DoneInvoke,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function je(t,e){var r="".concat(q.ErrorPlatform,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function ds(t){return{type:q.Pure,get:t}}function hs(t,e){if(!X&&(!t||typeof t=="function")){var r=t;t=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=typeof r=="function"?r.apply(void 0,W([],B(n),!1)):r;if(!s)throw new Error("Attempted to forward event to undefined actor. This risks an infinite loop in the sender.");return s}}return Re(function(n,i){return i},T(T({},e),{to:t}))}function fs(t,e){return nr(function(r,n,i){return{type:Xt,data:G(t)?t(r,n,i):t}},T(T({},e),{to:xe.Parent}))}function ps(t){return{type:q.Choose,conds:t}}var vs=function(t){var e,r,n=[];try{for(var i=F(t),s=i.next();!s.done;s=i.next())for(var o=s.value,d=0;d<o.actions.length;){if(o.actions[d].type===pt){n.push(o.actions[d]),o.actions.splice(d,1);continue}d++}}catch(u){e={error:u}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n};function tt(t,e,r,n,i,s,o){o===void 0&&(o=!1);var d=o?[]:vs(i),u=d.length?rn(r,n,d,e):r,l=o?[r]:void 0,a=[];function c(p,m){var O;switch(m.type){case Pe:{var E=cn(m,u,n,t.options.delays);return s&&typeof E.delay=="number"&&s(E,u,n),E}case Je:var A=un(m,u,n,t.options.delays);if(!X){var w=m.delay;ie(!H(w)||typeof A.delay=="number","No delay reference for delay expression '".concat(w,"' was found on machine '").concat(t.id,"'"))}return s&&A.to!==xe.Internal&&(p==="entry"?a.push(A):s(A,u,n)),A;case vt:{var x=ln(m,u,n);return s==null||s(x,u,n),x}case $r:{var P=m,k=(O=P.conds.find(function(v){var S=nn(v.cond,t.options.guards);return!S||sn(t,S,u,n,s?void 0:e)}))===null||O===void 0?void 0:O.actions;if(!k)return[];var I=B(tt(t,e,u,n,[{type:p,actions:Te(de(k),t.options.actions)}],s,o),2),U=I[0],R=I[1];return u=R,l==null||l.push(u),U}case zr:{var k=m.get(u,n.data);if(!k)return[];var z=B(tt(t,e,u,n,[{type:p,actions:Te(de(k),t.options.actions)}],s,o),2),N=z[0],V=z[1];return u=V,l==null||l.push(u),N}case ft:{var x=pn(m,u,n);return s==null||s(x,r,n),x}case pt:{u=rn(u,n,[m],s?void 0:e),l==null||l.push(u);break}default:var Q=Me(m,t.options.actions),$=Q.exec;if(s)s(Q,u,n);else if($&&l){var we=l.length-1,ve=T(T({},Q),{exec:function(v){for(var S=[],D=1;D<arguments.length;D++)S[D-1]=arguments[D];$.apply(void 0,W([l[we]],B(S),!1))}});Q=ve}return Q}}function h(p){var m,O,E=[];try{for(var A=F(p.actions),w=A.next();!w.done;w=A.next()){var x=w.value,P=c(p.type,x);P&&(E=E.concat(P))}}catch(k){m={error:k}}finally{try{w&&!w.done&&(O=A.return)&&O.call(A)}finally{if(m)throw m.error}}return a.forEach(function(k){s(k,u,n)}),a.length=0,E}var f=Z(i.map(h));return[f,u]}const ms=Object.freeze(Object.defineProperty({__proto__:null,actionTypes:Ki,after:mn,assign:vn,cancel:dn,choose:ps,done:Ze,doneInvoke:et,error:je,escalate:fs,forwardTo:hs,getActionFunction:At,initEvent:Ne,isActionObject:ls,log:us,pure:ds,raise:an,resolveActions:tt,resolveLog:ln,resolveRaise:cn,resolveSend:un,resolveStop:pn,respond:as,send:Re,sendParent:nr,sendTo:ss,sendUpdate:os,start:hn,stop:fn,toActionObject:Me,toActionObjects:Te,toActivityDefinition:Ot},Symbol.toStringTag,{value:"Module"}));var bt=[],Fe=function(t,e){bt.push(t);var r=e(t);return bt.pop(),r},ys=function(t){return t(bt[bt.length-1])};function yn(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[Ae]=function(){return this},e}function gs(t,e,r,n){var i,s=on(t.src),o=(i=e==null?void 0:e.options.services)===null||i===void 0?void 0:i[s.type],d=t.data?St(t.data,r,n):void 0,u=o?ir(o,t.id,d):yn(t.id);return u.meta=t,u}function ir(t,e,r){var n=yn(e);if(n.deferred=!0,Ee(t)){var i=n.state=Fe(void 0,function(){return(r?t.withContext(r):t).initialState});n.getSnapshot=function(){return i}}return n}function Es(t){try{return typeof t.send=="function"}catch{return!1}}function Ts(t){return Es(t)&&"id"in t}function Ss(t){var e;return T((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[Ae]=function(){return this},e),t)}var kt=function(t){return t.type==="atomic"||t.type==="final"};function gn(t){return Object.keys(t.states).map(function(e){return t.states[e]})}function rt(t){return gn(t).filter(function(e){return e.type!=="history"})}function En(t){var e=[t];return kt(t)?e:e.concat(Z(rt(t).map(En)))}function nt(t,e){var r,n,i,s,o,d,u,l,a=new Set(t),c=sr(a),h=new Set(e);try{for(var f=F(h),p=f.next();!p.done;p=f.next())for(var m=p.value,O=m.parent;O&&!h.has(O);)h.add(O),O=O.parent}catch(R){r={error:R}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}var E=sr(h);try{for(var A=F(h),w=A.next();!w.done;w=A.next()){var m=w.value;if(m.type==="compound"&&(!E.get(m)||!E.get(m).length))c.get(m)?c.get(m).forEach(function(z){return h.add(z)}):m.initialStateNodes.forEach(function(z){return h.add(z)});else if(m.type==="parallel")try{for(var x=(o=void 0,F(rt(m))),P=x.next();!P.done;P=x.next()){var k=P.value;h.has(k)||(h.add(k),c.get(k)?c.get(k).forEach(function(z){return h.add(z)}):k.initialStateNodes.forEach(function(z){return h.add(z)}))}}catch(z){o={error:z}}finally{try{P&&!P.done&&(d=x.return)&&d.call(x)}finally{if(o)throw o.error}}}}catch(R){i={error:R}}finally{try{w&&!w.done&&(s=A.return)&&s.call(A)}finally{if(i)throw i.error}}try{for(var I=F(h),U=I.next();!U.done;U=I.next())for(var m=U.value,O=m.parent;O&&!h.has(O);)h.add(O),O=O.parent}catch(R){u={error:R}}finally{try{U&&!U.done&&(l=I.return)&&l.call(I)}finally{if(u)throw u.error}}return h}function Tn(t,e){var r=e.get(t);if(!r)return{};if(t.type==="compound"){var n=r[0];if(n){if(kt(n))return n.key}else return{}}var i={};return r.forEach(function(s){i[s.key]=Tn(s,e)}),i}function sr(t){var e,r,n=new Map;try{for(var i=F(t),s=i.next();!s.done;s=i.next()){var o=s.value;n.has(o)||n.set(o,[]),o.parent&&(n.has(o.parent)||n.set(o.parent,[]),n.get(o.parent).push(o))}}catch(d){e={error:d}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function ws(t,e){var r=nt([t],e);return Tn(t,sr(r))}function it(t,e){return Array.isArray(t)?t.some(function(r){return r===e}):t instanceof Set?t.has(e):!1}function xs(t){return W([],B(new Set(Z(W([],B(t.map(function(e){return e.ownEvents})),!1)))),!1)}function It(t,e){return e.type==="compound"?rt(e).some(function(r){return r.type==="final"&&it(t,r)}):e.type==="parallel"?rt(e).every(function(r){return It(t,r)}):!1}function As(t){return t===void 0&&(t=[]),t.reduce(function(e,r){return r.meta!==void 0&&(e[r.id]=r.meta),e},{})}function Sn(t){return new Set(Z(t.map(function(e){return e.tags})))}function wn(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(H(t)||H(e))return t===e;var r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every(function(i){return wn(t[i],e[i])})}function Os(t){return typeof t!="object"||t===null?!1:"value"in t&&"_event"in t}function bs(t,e){var r=t.exec,n=T(T({},t),{exec:r!==void 0?function(){return r(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return n}var he=function(){function t(e){var r=this,n;this.actions=[],this.activities=Wr,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||Wr,this.meta=As(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(n=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&n!==void 0?n:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return xs(r.configuration)}})}return t.from=function(e,r){if(e instanceof t)return e.context!==r?new t({value:e.value,context:r,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var n=Ne;return new t({value:e,context:r,_event:n,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,r){if(e instanceof t){if(!e.actions.length)return e;var n=Ne;return new t({value:e.value,context:r,_event:n,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,r)},t.prototype.toStrings=function(e,r){var n=this;if(e===void 0&&(e=this.value),r===void 0&&(r="."),H(e))return[e];var i=Object.keys(e);return i.concat.apply(i,W([],B(i.map(function(s){return n.toStrings(e[s],r).map(function(o){return s+r+o})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var r=e.tags;e.machine;var n=Jt(e,["configuration","transitions","tags","machine"]);return T(T({},n),{tags:Array.from(r)})},t.prototype.matches=function(e){return er(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var r;X&&ie(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=(r=this.machine)===null||r===void 0?void 0:r.getTransitionData(this,e);return!!(n!=null&&n.transitions.length)&&n.transitions.some(function(i){return i.target!==void 0||i.actions.length})},t}(),ks={deferEvents:!1},xn=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=T(T({},ks),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(r){throw this.clear(),r}finally{this.processingEvent=!1}},t}(),or=new Map,Is=0,st={bookId:function(){return"x:".concat(Is++)},register:function(t,e){return or.set(t,e),t},get:function(t){return or.get(t)},free:function(t){or.delete(t)}};function ar(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;X||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues")}function _s(){var t=ar();if(t&&"__xstate__"in t)return t.__xstate__}function Ns(t){if(ar()){var e=_s();e&&e.register(t)}}function Rs(t,e){e===void 0&&(e={});var r=t.initialState,n=new Set,i=[],s=!1,o=function(){if(!s){for(s=!0;i.length>0;){var l=i.shift();r=t.transition(r,l,u),n.forEach(function(a){return a.next(r)})}s=!1}},d=Ss({id:e.id,send:function(l){i.push(l),o()},getSnapshot:function(){return r},subscribe:function(l,a,c){var h=Xe(l,a,c);return n.add(h),h.next(r),{unsubscribe:function(){n.delete(h)}}}}),u={parent:e.parent,self:d,id:e.id||"anonymous",observers:n};return r=t.start?t.start(u):r,d}var cr={sync:!1,autoForward:!1},te;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(te||(te={}));var Ds=function(){function t(e,r){r===void 0&&(r=t.defaultOptions);var n=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=te.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(a,c){if(Le(a))return n.batch(a),n.state;var h=ae(wt(a,c));if(n.status===te.Stopped)return X||ie(!1,'Event "'.concat(h.name,'" was sent to stopped service "').concat(n.machine.id,`". This service has already reached its final state, and will not transition.
Event: `).concat(JSON.stringify(h.data))),n.state;if(n.status!==te.Running&&!n.options.deferEvents)throw new Error('Event "'.concat(h.name,'" was sent to uninitialized service "').concat(n.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(h.data)));return n.scheduler.schedule(function(){n.forward(h);var f=n._nextState(h);n.update(f,h)}),n._state},this.sendTo=function(a,c,h){var f=n.parent&&(c===xe.Parent||n.parent.id===c),p=f?n.parent:H(c)?c===xe.Internal?n:n.children.get(c)||st.get(c):ts(c)?c:void 0;if(!p){if(!f)throw new Error("Unable to send event to child '".concat(c,"' from service '").concat(n.id,"'."));X||ie(!1,"Service '".concat(n.id,"' has no parent: unable to send event ").concat(a.type));return}if("machine"in p){if(n.status!==te.Stopped||n.parent!==p||n.state.done){var m=T(T({},a),{name:a.name===Xt?"".concat(je(n.id)):a.name,origin:n.sessionId});!h&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([p,m]):p.send(m)}}else!h&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([p,a.data]):p.send(a.data)},this._exec=function(a,c,h,f){f===void 0&&(f=n.machine.options.actions);var p=a.exec||At(a.type,f),m=G(p)?p:p?p.exec:a.exec;if(m)try{return m(c,h.data,n.machine.config.predictableActionArguments?{action:a,_event:h}:{action:a,state:n.state,_event:h})}catch($){throw n.parent&&n.parent.send({type:"xstate.error",data:$}),$}switch(a.type){case Pe:{var O=a;n.defer(O);break}case Je:var E=a;if(typeof E.delay=="number"){n.defer(E);return}else E.to?n.sendTo(E._event,E.to,h===Ne):n.send(E._event);break;case Wt:n.cancel(a.sendId);break;case ht:{if(n.status!==te.Running)return;var A=a.activity;if(!n.machine.config.predictableActionArguments&&!n.state.activities[A.id||A.type])break;if(A.type===q.Invoke){var w=on(A.src),x=n.machine.options.services?n.machine.options.services[w.type]:void 0,P=A.id,k=A.data;X||ie(!("forward"in A),"`forward` property is deprecated (found in invocation of '".concat(A.src,"' in in machine '").concat(n.machine.id,"'). ")+"Please use `autoForward` instead.");var I="autoForward"in A?A.autoForward:!!A.forward;if(!x){X||ie(!1,"No service found for invocation '".concat(A.src,"' in machine '").concat(n.machine.id,"'."));return}var U=k?St(k,c,h):void 0;if(typeof x=="string")return;var R=G(x)?x(c,h.data,{data:U,src:w,meta:A.meta}):x;if(!R)return;var z=void 0;Ee(R)&&(R=U?R.withContext(U):R,z={autoForward:I}),n.spawn(R,P,z)}else n.spawnActivity(A);break}case ft:{n.stopChild(a.activity.id);break}case vt:var N=a,V=N.label,Q=N.value;V?n.logger(V,Q):n.logger(Q);break;default:X||ie(!1,"No implementation found for action type '".concat(a.type,"'"));break}};var i=T(T({},t.defaultOptions),r),s=i.clock,o=i.logger,d=i.parent,u=i.id,l=u!==void 0?u:e.id;this.id=l,this.logger=o,this.clock=s,this.parent=d,this.options=i,this.scheduler=new xn({deferEvents:this.options.deferEvents}),this.sessionId=st.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:Fe(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return X||ie(this.status!==te.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,r){var n,i;try{for(var s=F(e.actions),o=s.next();!o.done;o=s.next()){var d=o.value;this.exec(d,e,r)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},t.prototype.update=function(e,r){var n,i,s,o,d,u,l,a,c=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||r===Ne)&&this.options.execute)this.execute(this.state);else for(var h=void 0;h=this._outgoingQueue.shift();)h[0].send(h[1]);if(this.children.forEach(function(R){c.state.children[R.id]=R}),this.devTools&&this.devTools.send(r.data,e),e.event)try{for(var f=F(this.eventListeners),p=f.next();!p.done;p=f.next()){var m=p.value;m(e.event)}}catch(R){n={error:R}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}try{for(var O=F(this.listeners),E=O.next();!E.done;E=O.next()){var m=E.value;m(e,e.event)}}catch(R){s={error:R}}finally{try{E&&!E.done&&(o=O.return)&&o.call(O)}finally{if(s)throw s.error}}try{for(var A=F(this.contextListeners),w=A.next();!w.done;w=A.next()){var x=w.value;x(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(R){d={error:R}}finally{try{w&&!w.done&&(u=A.return)&&u.call(A)}finally{if(d)throw d.error}}if(this.state.done){var P=e.configuration.find(function(R){return R.type==="final"&&R.parent===c.machine}),k=P&&P.doneData?St(P.doneData,e.context,r):void 0;this._doneEvent=et(this.id,k);try{for(var I=F(this.doneListeners),U=I.next();!U.done;U=I.next()){var m=U.value;m(this._doneEvent)}}catch(R){l={error:R}}finally{try{U&&!U.done&&(a=I.return)&&a.call(I)}finally{if(l)throw l.error}}this._stop(),this._stopChildren(),st.free(this.sessionId)}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===te.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,r,n){var i=this,s=Xe(e,r,n);this.listeners.add(s.next),this.status!==te.NotStarted&&s.next(this.state);var o=function(){i.doneListeners.delete(o),i.stopListeners.delete(o),s.complete()};return this.status===te.Stopped?s.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){i.listeners.delete(s.next),i.doneListeners.delete(o),i.stopListeners.delete(o)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.status===te.Stopped&&this._doneEvent?e(this._doneEvent):this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var r=this;if(this.status===te.Running)return this;this.machine._init(),st.register(this.sessionId,this),this.initialized=!0,this.status=te.Running;var n=e===void 0?this.initialState:Fe(this,function(){return Os(e)?r.machine.resolveState(e):r.machine.resolveState(he.from(e,r.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){r.update(n,Ne)}),this},t.prototype._stopChildren=function(){this.children.forEach(function(e){G(e.stop)&&e.stop()}),this.children.clear()},t.prototype._stop=function(){var e,r,n,i,s,o,d,u,l,a;try{for(var c=F(this.listeners),h=c.next();!h.done;h=c.next()){var f=h.value;this.listeners.delete(f)}}catch(I){e={error:I}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}try{for(var p=F(this.stopListeners),m=p.next();!m.done;m=p.next()){var f=m.value;f(),this.stopListeners.delete(f)}}catch(I){n={error:I}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}try{for(var O=F(this.contextListeners),E=O.next();!E.done;E=O.next()){var f=E.value;this.contextListeners.delete(f)}}catch(I){s={error:I}}finally{try{E&&!E.done&&(o=O.return)&&o.call(O)}finally{if(s)throw s.error}}try{for(var A=F(this.doneListeners),w=A.next();!w.done;w=A.next()){var f=w.value;this.doneListeners.delete(f)}}catch(I){d={error:I}}finally{try{w&&!w.done&&(u=A.return)&&u.call(A)}finally{if(d)throw d.error}}if(!this.initialized)return this;this.initialized=!1,this.status=te.Stopped,this._initialState=void 0;try{for(var x=F(Object.keys(this.delayedEventsMap)),P=x.next();!P.done;P=x.next()){var k=P.value;this.clock.clearTimeout(this.delayedEventsMap[k])}}catch(I){l={error:I}}finally{try{P&&!P.done&&(a=x.return)&&a.call(x)}finally{if(l)throw l.error}}this.scheduler.clear(),this.scheduler=new xn({deferEvents:this.options.deferEvents})},t.prototype.stop=function(){var e=this,r=this.scheduler;return this._stop(),r.schedule(function(){var n;if(!(!((n=e._state)===null||n===void 0)&&n.done)){var i=ae({type:"xstate.stop"}),s=Fe(e,function(){var o=Z(W([],B(e.state.configuration),!1).sort(function(c,h){return h.order-c.order}).map(function(c){return Te(c.onExit,e.machine.options.actions)})),d=B(tt(e.machine,e.state,e.state.context,i,[{type:"exit",actions:o}],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),u=d[0],l=d[1],a=new he({value:e.state.value,context:l,_event:i,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:u.filter(function(c){return!rr(c)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return a.changed=!0,a});e.update(s,i),e._stopChildren(),st.free(e.sessionId)}}),this},t.prototype.batch=function(e){var r=this;if(this.status===te.NotStarted&&this.options.deferEvents)X||ie(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,`" and are deferred. Make sure .start() is called for this service.
Event: `).concat(JSON.stringify(event)));else if(this.status!==te.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(e.length){var n=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var i,s,o=r.state,d=!1,u=[],l=function(f){var p=ae(f);r.forward(p),o=Fe(r,function(){return r.machine.transition(o,p,void 0,n||void 0)}),u.push.apply(u,W([],B(r.machine.config.predictableActionArguments?o.actions:o.actions.map(function(m){return bs(m,o)})),!1)),d=d||!!o.changed};try{for(var a=F(e),c=a.next();!c.done;c=a.next()){var h=c.value;l(h)}}catch(f){i={error:f}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}o.changed=d,o.actions=u,r.update(o,ae(e[e.length-1]))})}},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype._nextState=function(e,r){var n=this;r===void 0&&(r=!!this.machine.config.predictableActionArguments&&this._exec);var i=ae(e);if(i.name.indexOf(Qt)===0&&!this.state.nextEvents.some(function(o){return o.indexOf(Qt)===0}))throw i.data.data;var s=Fe(this,function(){return n.machine.transition(n.state,i,void 0,r||void 0)});return s},t.prototype.nextState=function(e){return this._nextState(e,!1)},t.prototype.forward=function(e){var r,n;try{for(var i=F(this.forwardTo),s=i.next();!s.done;s=i.next()){var o=s.value,d=this.children.get(o);if(!d)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));d.send(e)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.defer=function(e){var r=this,n=this.clock.setTimeout(function(){"to"in e&&e.to?r.sendTo(e._event,e.to,!0):r.send(e._event)},e.delay);e.id&&(this.delayedEventsMap[e.id]=n)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,r,n){n===void 0&&(n=this.machine.options.actions),this._exec(e,r.context,r._event,n)},t.prototype.removeChild=function(e){var r;this.children.delete(e),this.forwardTo.delete(e),(r=this.state)===null||r===void 0||delete r.children[e]},t.prototype.stopChild=function(e){var r=this.children.get(e);r&&(this.removeChild(e),G(r.stop)&&r.stop())},t.prototype.spawn=function(e,r,n){if(this.status!==te.Running)return ir(e,r);if(en(e))return this.spawnPromise(Promise.resolve(e),r);if(G(e))return this.spawnCallback(e,r);if(Ts(e))return this.spawnActor(e,r);if(es(e))return this.spawnObservable(e,r);if(Ee(e))return this.spawnMachine(e,T(T({},n),{id:r}));if(Qi(e))return this.spawnBehavior(e,r);throw new Error('Unable to spawn entity "'.concat(r,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,r){var n=this;r===void 0&&(r={});var i=new t(e,T(T({},this.options),{parent:this,id:r.id||e.id})),s=T(T({},cr),r);s.sync&&i.onTransition(function(d){n.send(yt,{state:d,id:i.id})});var o=i;return this.children.set(i.id,o),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(d){n.removeChild(i.id),n.send(ae(d,{origin:i.id}))}).start(),o},t.prototype.spawnBehavior=function(e,r){var n=Rs(e,{id:r,parent:this});return this.children.set(r,n),n},t.prototype.spawnPromise=function(e,r){var n,i=this,s=!1,o;e.then(function(u){s||(o=u,i.removeChild(r),i.send(ae(et(r,u),{origin:r})))},function(u){if(!s){i.removeChild(r);var l=je(r,u);try{i.send(ae(l,{origin:r}))}catch(a){is(u,a,r),i.devTools&&i.devTools.send(l,i.state),i.machine.strict&&i.stop()}}});var d=(n={id:r,send:function(){},subscribe:function(u,l,a){var c=Xe(u,l,a),h=!1;return e.then(function(f){h||(c.next(f),!h&&c.complete())},function(f){h||c.error(f)}),{unsubscribe:function(){return h=!0}}},stop:function(){s=!0},toJSON:function(){return{id:r}},getSnapshot:function(){return o}},n[Ae]=function(){return this},n);return this.children.set(r,d),d},t.prototype.spawnCallback=function(e,r){var n,i=this,s=!1,o=new Set,d=new Set,u,l=function(h){u=h,d.forEach(function(f){return f(h)}),!s&&i.send(ae(h,{origin:r}))},a;try{a=e(l,function(h){o.add(h)})}catch(h){this.send(je(r,h))}if(en(a))return this.spawnPromise(a,r);var c=(n={id:r,send:function(h){return o.forEach(function(f){return f(h)})},subscribe:function(h){var f=Xe(h);return d.add(f.next),{unsubscribe:function(){d.delete(f.next)}}},stop:function(){s=!0,G(a)&&a()},toJSON:function(){return{id:r}},getSnapshot:function(){return u}},n[Ae]=function(){return this},n);return this.children.set(r,c),c},t.prototype.spawnObservable=function(e,r){var n,i=this,s,o=e.subscribe(function(u){s=u,i.send(ae(u,{origin:r}))},function(u){i.removeChild(r),i.send(ae(je(r,u),{origin:r}))},function(){i.removeChild(r),i.send(ae(et(r),{origin:r}))}),d=(n={id:r,send:function(){},subscribe:function(u,l,a){return e.subscribe(u,l,a)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return s},toJSON:function(){return{id:r}}},n[Ae]=function(){return this},n);return this.children.set(r,d),d},t.prototype.spawnActor=function(e,r){return this.children.set(r,e),e},t.prototype.spawnActivity=function(e){var r=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!r){X||ie(!1,"No implementation found for activity '".concat(e.type,"'"));return}var n=r(this.state.context,e);this.spawnEffect(e.id,n)},t.prototype.spawnEffect=function(e,r){var n;this.children.set(e,(n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:r||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},n[Ae]=function(){return this},n))},t.prototype.attachDev=function(){var e=ar();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var r=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(T(T({name:this.id,autoPause:!0,stateSanitizer:function(n){return{value:n.value,context:n.context,actions:n.actions}}},r),{features:T({jump:!1,skip:!1},r?r.features:void 0)}),this.machine),this.devTools.init(this.state)}Ns(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[Ae]=function(){return this},t.prototype.getSnapshot=function(){return this.status===te.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,r){return setTimeout(e,r)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},t.interpret=De,t}(),Cs=function(t){return H(t)?T(T({},cr),{name:t}):T(T(T({},cr),{name:rs()}),t)};function Ps(t,e){var r=Cs(e);return ys(function(n){if(!X){var i=Ee(t)||G(t);ie(!!n||i,'Attempted to spawn an Actor (ID: "'.concat(Ee(t)?t.id:"undefined",'") outside of a service. This will have no effect.'))}return n?n.spawn(t,r.name,r):ir(t,r.name)})}function De(t,e){var r=new Ds(t,e);return r}function Ls(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function _t(t){return T(T({type:mt},t),{toJSON:function(){t.onDone,t.onError;var e=Jt(t,["onDone","onError"]);return T(T({},e),{type:mt,src:Ls(t.src)})}})}var Ve="",ur="#",ot="*",Be={},Ge=function(t){return t[0]===ur},Us=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},Ms=function(t,e,r){var n=r.slice(0,-1).some(function(s){return!("cond"in s)&&!("in"in s)&&(H(s.target)||Ee(s.target))}),i=e===Ve?"the transient event":"event '".concat(e,"'");ie(!n,"One or more transitions for ".concat(i," on state '").concat(t.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")},js=function(){function t(e,r,n,i){n===void 0&&(n="context"in e?e.context:void 0);var s=this,o;this.config=e,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(Us(),r),this.parent=i==null?void 0:i.parent,this.key=this.config.key||(i==null?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:Jr),this.id=this.config.id||W([this.machine.key],B(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(o=this.config.schema)!==null&&o!==void 0?o:{},this.description=this.config.description,X||ie(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?Qe(this.config.states,function(l,a){var c,h=new t(l,{},void 0,{parent:s,key:a});return Object.assign(s.idMap,T((c={},c[h.id]=h,c),h.idMap)),h}):Be;var d=0;function u(l){var a,c;l.order=d++;try{for(var h=F(gn(l)),f=h.next();!f.done;f=h.next()){var p=f.value;u(p)}}catch(m){a={error:m}}finally{try{f&&!f.done&&(c=h.return)&&c.call(h)}finally{if(a)throw a.error}}}u(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(l){var a=l.event;return a===Ve}):Ve in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=de(this.config.entry||this.config.onEntry).map(function(l){return Me(l)}),this.onExit=de(this.config.exit||this.config.onExit).map(function(l){return Me(l)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=de(this.config.invoke).map(function(l,a){var c,h;if(Ee(l)){var f=xt(s.id,a);return s.machine.options.services=T((c={},c[f]=l,c),s.machine.options.services),_t({src:f,id:f})}else if(H(l.src)){var f=l.id||xt(s.id,a);return _t(T(T({},l),{id:f,src:l.src}))}else if(Ee(l.src)||G(l.src)){var f=l.id||xt(s.id,a);return s.machine.options.services=T((h={},h[f]=l.src,h),s.machine.options.services),_t(T(T({id:f},l),{src:f}))}else{var p=l.src;return _t(T(T({id:xt(s.id,a)},l),{src:p}))}}),this.activities=de(this.config.activities).concat(this.invoke).map(function(l){return Ot(l)}),this.transition=this.transition.bind(this),this.tags=de(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||En(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,r){var n=this.options,i=n.actions,s=n.activities,o=n.guards,d=n.services,u=n.delays;return new t(this.config,{actions:T(T({},i),e.actions),activities:T(T({},s),e.activities),guards:T(T({},o),e.guards),services:T(T({},d),e.services),delays:T(T({},u),e.delays)},r!=null?r:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return G(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:Qe(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(r,n){return r[n.eventType]=r[n.eventType]||[],r[n.eventType].push(n),r},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var r=e===Ve,n=this.transitions.filter(function(i){var s=i.eventType===e;return r?s:s||i.eventType===ot});return this.__cache.candidates[e]=n,n},t.prototype.getDelayedTransitions=function(){var e=this,r=this.config.after;if(!r)return[];var n=function(s,o){var d=G(s)?"".concat(e.id,":delay[").concat(o,"]"):s,u=mn(d,e.id);return e.onEntry.push(Re(u,{delay:s})),e.onExit.push(dn(u)),u},i=Le(r)?r.map(function(s,o){var d=n(s.delay,o);return T(T({},s),{event:d})}):Z(Object.keys(r).map(function(s,o){var d=r[s],u=H(d)?{target:d}:d,l=isNaN(+s)?s:+s,a=n(l,o);return de(u).map(function(c){return T(T({},c),{event:a,delay:l})})}));return i.map(function(s){var o=s.delay;return T(T({},e.formatTransition(s)),{delay:o})})},t.prototype.getStateNodes=function(e){var r,n=this;if(!e)return[];var i=e instanceof he?e.value:We(e,this.delimiter);if(H(i)){var s=this.getStateNode(i).initial;return s!==void 0?this.getStateNodes((r={},r[i]=s,r)):[this,this.states[i]]}var o=Object.keys(i),d=[this];return d.push.apply(d,W([],B(Z(o.map(function(u){return n.getStateNode(u).getStateNodes(i[u])}))),!1)),d},t.prototype.handles=function(e){var r=Qr(e);return this.events.includes(r)},t.prototype.resolveState=function(e){var r=e instanceof he?e:he.create(e),n=Array.from(nt([],this.getStateNodes(r.value)));return new he(T(T({},r),{value:this.resolve(r.value),configuration:n,done:It(n,this),tags:Sn(n),machine:this.machine}))},t.prototype.transitionLeafNode=function(e,r,n){var i=this.getStateNode(e),s=i.next(r,n);return!s||!s.transitions.length?this.next(r,n):s},t.prototype.transitionCompoundNode=function(e,r,n){var i=Object.keys(e),s=this.getStateNode(i[0]),o=s._transition(e[i[0]],r,n);return!o||!o.transitions.length?this.next(r,n):o},t.prototype.transitionParallelNode=function(e,r,n){var i,s,o={};try{for(var d=F(Object.keys(e)),u=d.next();!u.done;u=d.next()){var l=u.value,a=e[l];if(a){var c=this.getStateNode(l),h=c._transition(a,r,n);h&&(o[l]=h)}}}catch(E){i={error:E}}finally{try{u&&!u.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}var f=Object.keys(o).map(function(E){return o[E]}),p=Z(f.map(function(E){return E.transitions})),m=f.some(function(E){return E.transitions.length>0});if(!m)return this.next(r,n);var O=Z(Object.keys(o).map(function(E){return o[E].configuration}));return{transitions:p,exitSet:Z(f.map(function(E){return E.exitSet})),configuration:O,source:r,actions:Z(Object.keys(o).map(function(E){return o[E].actions}))}},t.prototype._transition=function(e,r,n){return H(e)?this.transitionLeafNode(e,r,n):Object.keys(e).length===1?this.transitionCompoundNode(e,r,n):this.transitionParallelNode(e,r,n)},t.prototype.getTransitionData=function(e,r){return this._transition(e.value,e,ae(r))},t.prototype.next=function(e,r){var n,i,s=this,o=r.name,d=[],u=[],l;try{for(var a=F(this.getCandidates(o)),c=a.next();!c.done;c=a.next()){var h=c.value,f=h.cond,p=h.in,m=e.context,O=p?H(p)&&Ge(p)?e.matches(We(this.getStateNodeById(p).path,this.delimiter)):er(We(p,this.delimiter),zi(this.path.slice(0,-2))(e.value)):!0,E=!1;try{E=!f||sn(this.machine,f,m,r,e)}catch(x){throw new Error("Unable to evaluate guard '".concat(f.name||f.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(x.message))}if(E&&O){h.target!==void 0&&(u=h.target),d.push.apply(d,W([],B(h.actions),!1)),l=h;break}}}catch(x){n={error:x}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}if(l){if(!u.length)return{transitions:[l],exitSet:[],configuration:e.value?[this]:[],source:e,actions:d};var A=Z(u.map(function(x){return s.getRelativeStateNodes(x,e.historyValue)})),w=!!l.internal;return{transitions:[l],exitSet:w?[]:Z(u.map(function(x){return s.getPotentiallyReenteringNodes(x)})),configuration:A,source:e,actions:d}}},t.prototype.getPotentiallyReenteringNodes=function(e){if(this.order<e.order)return[this];for(var r=[],n=this,i=e;n&&n!==i;)r.push(n),n=n.parent;return n!==i?[]:(r.push(i),r)},t.prototype.getActions=function(e,r,n,i,s,o,d){var u,l,a,c,h=this,f=o?nt([],this.getStateNodes(o.value)):[],p=new Set;try{for(var m=F(Array.from(e).sort(function(N,V){return N.order-V.order})),O=m.next();!O.done;O=m.next()){var E=O.value;(!it(f,E)||it(n.exitSet,E)||E.parent&&p.has(E.parent))&&p.add(E)}}catch(N){u={error:N}}finally{try{O&&!O.done&&(l=m.return)&&l.call(m)}finally{if(u)throw u.error}}try{for(var A=F(f),w=A.next();!w.done;w=A.next()){var E=w.value;(!it(e,E)||it(n.exitSet,E.parent))&&n.exitSet.push(E)}}catch(N){a={error:N}}finally{try{w&&!w.done&&(c=A.return)&&c.call(A)}finally{if(a)throw a.error}}n.exitSet.sort(function(N,V){return V.order-N.order});var x=Array.from(p).sort(function(N,V){return N.order-V.order}),P=new Set(n.exitSet),k=Z(x.map(function(N){var V=[];if(N.type!=="final")return V;var Q=N.parent;if(!Q.parent)return V;V.push(Ze(N.id,N.doneData),Ze(Q.id,N.doneData?St(N.doneData,i,s):void 0));var $=Q.parent;return $.type==="parallel"&&rt($).every(function(we){return It(n.configuration,we)})&&V.push(Ze($.id)),V})),I=x.map(function(N){var V=N.onEntry,Q=N.activities.map(function($){return hn($)});return{type:"entry",actions:Te(d?W(W([],B(V),!1),B(Q),!1):W(W([],B(Q),!1),B(V),!1),h.machine.options.actions)}}).concat({type:"state_done",actions:k.map(function(N){return an(N)})}),U=Array.from(P).map(function(N){return{type:"exit",actions:Te(W(W([],B(N.onExit),!1),B(N.activities.map(function(V){return fn(V)})),!1),h.machine.options.actions)}}),R=U.concat({type:"transition",actions:Te(n.actions,this.machine.options.actions)}).concat(I);if(r){var z=Te(Z(W([],B(e),!1).sort(function(N,V){return V.order-N.order}).map(function(N){return N.onExit})),this.machine.options.actions).filter(function(N){return!rr(N)});return R.concat({type:"stop",actions:z})}return R},t.prototype.transition=function(e,r,n,i){e===void 0&&(e=this.initialState);var s=ae(r),o;if(e instanceof he)o=n===void 0?e:this.resolveState(he.from(e,n));else{var d=H(e)?this.resolve(Et(this.getResolvedPath(e))):this.resolve(e),u=n!=null?n:this.machine.context;o=this.resolveState(he.from(d,u))}if(!X&&s.name===ot)throw new Error("An event cannot have the wildcard type ('".concat(ot,"')"));if(this.strict&&!this.events.includes(s.name)&&!Wi(s.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var l=this._transition(o.value,o,s)||{transitions:[],configuration:[],exitSet:[],source:o,actions:[]},a=nt([],this.getStateNodes(o.value)),c=l.configuration.length?nt(a,l.configuration):a;return l.configuration=W([],B(c),!1),this.resolveTransition(l,o,o.context,i,s)},t.prototype.resolveRaisedTransition=function(e,r,n,i){var s,o=e.actions;return e=this.transition(e,r,void 0,i),e._event=n,e.event=n.data,(s=e.actions).unshift.apply(s,W([],B(o),!1)),e},t.prototype.resolveTransition=function(e,r,n,i,s){var o,d,u,l,a=this;s===void 0&&(s=Ne);var c=e.configuration,h=!r||e.transitions.length>0,f=h?e.configuration:r?r.configuration:[],p=It(f,this),m=h?ws(this.machine,c):void 0,O=r?r.historyValue?r.historyValue:e.source?this.machine.historyValue(r.value):void 0:void 0,E=this.getActions(new Set(f),p,e,n,s,r,i),A=r?T({},r.activities):{};try{for(var w=F(E),x=w.next();!x.done;x=w.next()){var P=x.value;try{for(var k=(u=void 0,F(P.actions)),I=k.next();!I.done;I=k.next()){var U=I.value;U.type===ht?A[U.activity.id||U.activity.type]=U:U.type===ft&&(A[U.activity.id||U.activity.type]=!1)}}catch(ue){u={error:ue}}finally{try{I&&!I.done&&(l=k.return)&&l.call(k)}finally{if(u)throw u.error}}}}catch(ue){o={error:ue}}finally{try{x&&!x.done&&(d=w.return)&&d.call(w)}finally{if(o)throw o.error}}var R=B(tt(this,r,n,s,E,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),z=R[0],N=R[1],V=B(Xi(z,rr),2),Q=V[0],$=V[1],we=z.filter(function(ue){var ne;return ue.type===ht&&((ne=ue.activity)===null||ne===void 0?void 0:ne.type)===mt}),ve=we.reduce(function(ue,ne){return ue[ne.activity.id]=gs(ne.activity,a.machine,N,s),ue},r?T({},r.children):{}),v=new he({value:m||r.value,context:N,_event:s,_sessionid:r?r._sessionid:null,historyValue:m?O?Zi(O,m):void 0:r?r.historyValue:void 0,history:!m||e.source?r:void 0,actions:m?$:[],activities:m?A:r?r.activities:{},events:[],configuration:f,transitions:e.transitions,children:ve,done:p,tags:Sn(f),machine:this}),S=n!==N;v.changed=s.name===yt||S;var D=v.history;D&&delete D.history;var J=!p&&(this._transient||c.some(function(ue){return ue._transient}));if(!h&&(!J||s.name===Ve))return v;var Y=v;if(!p)for(J&&(Y=this.resolveRaisedTransition(Y,{type:Kr},s,i));Q.length;){var K=Q.shift();Y=this.resolveRaisedTransition(Y,K._event,s,i)}var $e=Y.changed||(D?!!Y.actions.length||S||typeof D.value!=typeof Y.value||!wn(Y.value,D.value):void 0);return Y.changed=$e,Y.history=D,Y},t.prototype.getStateNode=function(e){if(Ge(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var r=this.states[e];if(!r)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return r},t.prototype.getStateNodeById=function(e){var r=Ge(e)?e.slice(ur.length):e;if(r===this.id)return this;var n=this.machine.idMap[r];if(!n)throw new Error("Child state node '#".concat(r,"' does not exist on machine '").concat(this.id,"'"));return n},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&Ge(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var r=tr(e,this.delimiter).slice(),n=this;r.length;){var i=r.shift();if(!i.length)break;n=n.getStateNode(i)}return n},t.prototype.resolve=function(e){var r,n=this;if(!e)return this.initialStateValue||Be;switch(this.type){case"parallel":return Qe(this.initialStateValue,function(s,o){return s?n.getStateNode(o).resolve(e[o]||s):Be});case"compound":if(H(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(r={},r[e]=i.initialStateValue,r):e}return Object.keys(e).length?Qe(e,function(s,o){return s?n.getStateNode(o).resolve(s):Be}):this.initialStateValue||{};default:return e||Be}},t.prototype.getResolvedPath=function(e){if(Ge(e)){var r=this.machine.idMap[e.slice(ur.length)];if(!r)throw new Error("Unable to find state node '".concat(e,"'"));return r.path}return tr(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var r;if(this.type==="parallel")r=Xr(this.states,function(n){return n.initialStateValue||Be},function(n){return n.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));r=kt(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else r={};return this.__cache.initialStateValue=r,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,r){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,r!=null?r:this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var r=this.config;H(r.target)?e=Ge(r.target)?Et(this.machine.getStateNodeById(r.target).path.slice(this.path.length-1)):r.target:e=r.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,r,n){return n===void 0&&(n=!0),n?e.type==="history"?e.resolveHistory(r):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(kt(this))return[this];if(this.type==="compound"&&!this.initial)return X||ie(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this];var r=Tt(this.initialStateValue);return Z(r.map(function(n){return e.getFromRelativePath(n)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var r=B(e),n=r[0],i=r.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var s=this.getStateNode(n);if(s.type==="history")return s.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},t.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:Xr(this.states,function(r,n){if(!e)return r.historyValue();var i=H(e)?void 0:e[n];return r.historyValue(i||r.initialStateValue)},function(r){return!r.history})}},t.prototype.resolveHistory=function(e){var r=this;if(this.type!=="history")return[this];var n=this.parent;if(!e){var i=this.target;return i?Z(Tt(i).map(function(o){return n.getFromRelativePath(o)})):n.initialStateNodes}var s=Ji(n.path,"states")(e).current;return H(s)?[n.getStateNode(s)]:Z(Tt(s).map(function(o){return r.history==="deep"?n.getFromRelativePath(o):[n.states[o[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,r=Z(Object.keys(this.states).map(function(n){return e.states[n].stateIds}));return[this.id].concat(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,r,n,i;if(this.__cache.events)return this.__cache.events;var s=this.states,o=new Set(this.ownEvents);if(s)try{for(var d=F(Object.keys(s)),u=d.next();!u.done;u=d.next()){var l=u.value,a=s[l];if(a.states)try{for(var c=(n=void 0,F(a.events)),h=c.next();!h.done;h=c.next()){var f=h.value;o.add("".concat(f))}}catch(p){n={error:p}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}}catch(p){e={error:p}}finally{try{u&&!u.done&&(r=d.return)&&r.call(d)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(r){return!(!r.target&&!r.actions.length&&r.internal)}).map(function(r){return r.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var r=this;if(e!==void 0)return e.map(function(n){if(!H(n))return n;var i=n[0]===r.delimiter;if(i&&!r.parent)return r.getStateNodeByPath(n.slice(1));var s=i?r.key+n:n;if(r.parent)try{var o=r.parent.getStateNodeByPath(s);return o}catch(d){throw new Error("Invalid transition definition for state node '".concat(r.id,`':
`).concat(d.message))}else return r.getStateNodeByPath(s)})},t.prototype.formatTransition=function(e){var r=this,n=ns(e.target),i="internal"in e?e.internal:n?n.some(function(u){return H(u)&&u[0]===r.delimiter}):!0,s=this.machine.options.guards,o=this.resolveTarget(n),d=T(T({},e),{actions:Te(de(e.actions)),cond:nn(e.cond,s),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return T(T({},d),{target:d.target?d.target.map(function(u){return"#".concat(u.id)}):void 0,source:"#".concat(r.id)})}});return d},t.prototype.formatTransitions=function(){var e,r,n=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var s=this.config.on,o=ot,d=s[o],u=d===void 0?[]:d,l=Jt(s,[typeof o=="symbol"?o:o+""]);i=Z(Object.keys(l).map(function(A){!X&&A===Ve&&ie(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(n.id,'".'));var w=Ue(A,l[A]);return X||Ms(n,A,w),w}).concat(Ue(ot,u)))}var a=this.config.always?Ue("",this.config.always):[],c=this.config.onDone?Ue(String(Ze(this.id)),this.config.onDone):[];X||ie(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var h=Z(this.invoke.map(function(A){var w=[];return A.onDone&&w.push.apply(w,W([],B(Ue(String(et(A.id)),A.onDone)),!1)),A.onError&&w.push.apply(w,W([],B(Ue(String(je(A.id)),A.onError)),!1)),w})),f=this.after,p=Z(W(W(W(W([],B(c),!1),B(h),!1),B(i),!1),B(a),!1).map(function(A){return de(A).map(function(w){return n.formatTransition(w)})}));try{for(var m=F(f),O=m.next();!O.done;O=m.next()){var E=O.value;p.push(E)}}catch(A){e={error:A}}finally{try{O&&!O.done&&(r=m.return)&&r.call(m)}finally{if(e)throw e.error}}return p},t}(),An=!1;function Oe(t,e){return!X&&!("predictableActionArguments"in t)&&!An&&(An=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new js(t,e)}var M=vn,se=Re;/*! js-cookie v3.0.5 | MIT */function Nt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}var Fs={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function lr(t,e){function r(i,s,o){if(typeof document!="undefined"){o=Nt({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var d="";for(var u in o)o[u]&&(d+="; "+u,o[u]!==!0&&(d+="="+o[u].split(";")[0]));return document.cookie=i+"="+t.write(s,i)+d}}function n(i){if(!(typeof document=="undefined"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],o={},d=0;d<s.length;d++){var u=s[d].split("="),l=u.slice(1).join("=");try{var a=decodeURIComponent(u[0]);if(o[a]=t.read(l,a),i===a)break}catch{}}return i?o[i]:o}}return Object.create({set:r,get:n,remove:function(i,s){r(i,"",Nt({},s,{expires:-1}))},withAttributes:function(i){return lr(this.converter,Nt({},this.attributes,i))},withConverter:function(i){return lr(Nt({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var dr=lr(Fs,{path:"/"}),hr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function fr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Vs(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var pr={exports:{}};(function(t,e){(function(r){function n(i){var s=i&&i.Promise||r.Promise,o=i&&i.XMLHttpRequest||r.XMLHttpRequest;return function(){var d=Object.create(r,{fetch:{value:void 0,writable:!0}});return function(u,l){l(e)}(this,function(u){var l=typeof d!="undefined"&&d||typeof self!="undefined"&&self||typeof l!="undefined"&&l,a={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function c(v){return v&&DataView.prototype.isPrototypeOf(v)}if(a.arrayBuffer)var h=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(v){return v&&h.indexOf(Object.prototype.toString.call(v))>-1};function p(v){if(typeof v!="string"&&(v=String(v)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(v)||v==="")throw new TypeError("Invalid character in header field name");return v.toLowerCase()}function m(v){return typeof v!="string"&&(v=String(v)),v}function O(v){var S={next:function(){var D=v.shift();return{done:D===void 0,value:D}}};return a.iterable&&(S[Symbol.iterator]=function(){return S}),S}function E(v){this.map={},v instanceof E?v.forEach(function(S,D){this.append(D,S)},this):Array.isArray(v)?v.forEach(function(S){this.append(S[0],S[1])},this):v&&Object.getOwnPropertyNames(v).forEach(function(S){this.append(S,v[S])},this)}E.prototype.append=function(v,S){v=p(v),S=m(S);var D=this.map[v];this.map[v]=D?D+", "+S:S},E.prototype.delete=function(v){delete this.map[p(v)]},E.prototype.get=function(v){return v=p(v),this.has(v)?this.map[v]:null},E.prototype.has=function(v){return this.map.hasOwnProperty(p(v))},E.prototype.set=function(v,S){this.map[p(v)]=m(S)},E.prototype.forEach=function(v,S){for(var D in this.map)this.map.hasOwnProperty(D)&&v.call(S,this.map[D],D,this)},E.prototype.keys=function(){var v=[];return this.forEach(function(S,D){v.push(D)}),O(v)},E.prototype.values=function(){var v=[];return this.forEach(function(S){v.push(S)}),O(v)},E.prototype.entries=function(){var v=[];return this.forEach(function(S,D){v.push([D,S])}),O(v)},a.iterable&&(E.prototype[Symbol.iterator]=E.prototype.entries);function A(v){if(v.bodyUsed)return s.reject(new TypeError("Already read"));v.bodyUsed=!0}function w(v){return new s(function(S,D){v.onload=function(){S(v.result)},v.onerror=function(){D(v.error)}})}function x(v){var S=new FileReader,D=w(S);return S.readAsArrayBuffer(v),D}function P(v){var S=new FileReader,D=w(S);return S.readAsText(v),D}function k(v){for(var S=new Uint8Array(v),D=new Array(S.length),J=0;J<S.length;J++)D[J]=String.fromCharCode(S[J]);return D.join("")}function I(v){if(v.slice)return v.slice(0);var S=new Uint8Array(v.byteLength);return S.set(new Uint8Array(v)),S.buffer}function U(){return this.bodyUsed=!1,this._initBody=function(v){this.bodyUsed=this.bodyUsed,this._bodyInit=v,v?typeof v=="string"?this._bodyText=v:a.blob&&Blob.prototype.isPrototypeOf(v)?this._bodyBlob=v:a.formData&&FormData.prototype.isPrototypeOf(v)?this._bodyFormData=v:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)?this._bodyText=v.toString():a.arrayBuffer&&a.blob&&c(v)?(this._bodyArrayBuffer=I(v.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(v)||f(v))?this._bodyArrayBuffer=I(v):this._bodyText=v=Object.prototype.toString.call(v):this._bodyText="",this.headers.get("content-type")||(typeof v=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var v=A(this);if(v)return v;if(this._bodyBlob)return s.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return s.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var v=A(this);return v||(ArrayBuffer.isView(this._bodyArrayBuffer)?s.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):s.resolve(this._bodyArrayBuffer))}else return this.blob().then(x)}),this.text=function(){var v=A(this);if(v)return v;if(this._bodyBlob)return P(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(k(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return s.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(V)}),this.json=function(){return this.text().then(JSON.parse)},this}var R=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function z(v){var S=v.toUpperCase();return R.indexOf(S)>-1?S:v}function N(v,S){if(!(this instanceof N))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');S=S||{};var D=S.body;if(v instanceof N){if(v.bodyUsed)throw new TypeError("Already read");this.url=v.url,this.credentials=v.credentials,S.headers||(this.headers=new E(v.headers)),this.method=v.method,this.mode=v.mode,this.signal=v.signal,!D&&v._bodyInit!=null&&(D=v._bodyInit,v.bodyUsed=!0)}else this.url=String(v);if(this.credentials=S.credentials||this.credentials||"same-origin",(S.headers||!this.headers)&&(this.headers=new E(S.headers)),this.method=z(S.method||this.method||"GET"),this.mode=S.mode||this.mode||null,this.signal=S.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&D)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(D),(this.method==="GET"||this.method==="HEAD")&&(S.cache==="no-store"||S.cache==="no-cache")){var J=/([?&])_=[^&]*/;if(J.test(this.url))this.url=this.url.replace(J,"$1_="+new Date().getTime());else{var Y=/\?/;this.url+=(Y.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}N.prototype.clone=function(){return new N(this,{body:this._bodyInit})};function V(v){var S=new FormData;return v.trim().split("&").forEach(function(D){if(D){var J=D.split("="),Y=J.shift().replace(/\+/g," "),K=J.join("=").replace(/\+/g," ");S.append(decodeURIComponent(Y),decodeURIComponent(K))}}),S}function Q(v){var S=new E,D=v.replace(/\r?\n[\t ]+/g," ");return D.split("\r").map(function(J){return J.indexOf(`
`)===0?J.substr(1,J.length):J}).forEach(function(J){var Y=J.split(":"),K=Y.shift().trim();if(K){var $e=Y.join(":").trim();S.append(K,$e)}}),S}U.call(N.prototype);function $(v,S){if(!(this instanceof $))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');S||(S={}),this.type="default",this.status=S.status===void 0?200:S.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in S?S.statusText:"",this.headers=new E(S.headers),this.url=S.url||"",this._initBody(v)}U.call($.prototype),$.prototype.clone=function(){return new $(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new E(this.headers),url:this.url})},$.error=function(){var v=new $(null,{status:0,statusText:""});return v.type="error",v};var we=[301,302,303,307,308];$.redirect=function(v,S){if(we.indexOf(S)===-1)throw new RangeError("Invalid status code");return new $(null,{status:S,headers:{location:v}})},u.DOMException=l.DOMException;try{new u.DOMException}catch{u.DOMException=function(S,D){this.message=S,this.name=D;var J=Error(S);this.stack=J.stack},u.DOMException.prototype=Object.create(Error.prototype),u.DOMException.prototype.constructor=u.DOMException}function ve(v,S){return new s(function(D,J){var Y=new N(v,S);if(Y.signal&&Y.signal.aborted)return J(new u.DOMException("Aborted","AbortError"));var K=new o;function $e(){K.abort()}K.onload=function(){var ne={status:K.status,statusText:K.statusText,headers:Q(K.getAllResponseHeaders()||"")};ne.url="responseURL"in K?K.responseURL:ne.headers.get("X-Request-URL");var $t="response"in K?K.response:K.responseText;setTimeout(function(){D(new $($t,ne))},0)},K.onerror=function(){setTimeout(function(){J(new TypeError("Network request failed"))},0)},K.ontimeout=function(){setTimeout(function(){J(new TypeError("Network request failed"))},0)},K.onabort=function(){setTimeout(function(){J(new u.DOMException("Aborted","AbortError"))},0)};function ue(ne){try{return ne===""&&l.location.href?l.location.href:ne}catch{return ne}}K.open(Y.method,ue(Y.url),!0),Y.credentials==="include"?K.withCredentials=!0:Y.credentials==="omit"&&(K.withCredentials=!1),"responseType"in K&&(a.blob?K.responseType="blob":a.arrayBuffer&&Y.headers.get("Content-Type")&&Y.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(K.responseType="arraybuffer")),S&&typeof S.headers=="object"&&!(S.headers instanceof E)?Object.getOwnPropertyNames(S.headers).forEach(function(ne){K.setRequestHeader(ne,m(S.headers[ne]))}):Y.headers.forEach(function(ne,$t){K.setRequestHeader($t,ne)}),Y.signal&&(Y.signal.addEventListener("abort",$e),K.onreadystatechange=function(){K.readyState===4&&Y.signal.removeEventListener("abort",$e)}),K.send(typeof Y._bodyInit=="undefined"?null:Y._bodyInit)})}ve.polyfill=!0,l.fetch||(l.fetch=ve,l.Headers=E,l.Request=N,l.Response=$),u.Headers=E,u.Request=N,u.Response=$,u.fetch=ve,Object.defineProperty(u,"__esModule",{value:!0})}),{fetch:d.fetch,Headers:d.Headers,Request:d.Request,Response:d.Response,DOMException:d.DOMException}}()}t.exports=n})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:hr)})(pr,pr.exports);var Bs=pr.exports;const vr=fr(Bs),He="nhostRefreshToken",Rt="nhostRefreshTokenId",Ye="nhostRefreshTokenExpiresAt",Gs=3,Hs=60,On=5,bn=0,kn=1,me=10,Dt=20;let at=class extends Error{constructor(e){super(e.message),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),e instanceof Error?(this.name=e.name,this.error={error:e.name,status:kn,message:e.message}):(this.name=e.error,this.error=e)}};const be={status:me,error:"invalid-email",message:"Email is incorrectly formatted"},Ys={status:me,error:"invalid-mfa-type",message:"MFA type is invalid"},Ks={status:me,error:"invalid-mfa-code",message:"MFA code is invalid"},mr={status:me,error:"invalid-password",message:"Password is incorrectly formatted"},In={status:me,error:"invalid-phone-number",message:"Phone number is incorrectly formatted"},qs={status:me,error:"invalid-mfa-ticket",message:"MFA ticket is invalid"},$s={status:me,error:"no-mfa-ticket",message:"No MFA ticket has been provided"},zs={status:me,error:"no-refresh-token",message:"No refresh token has been provided"},Js={status:Dt,error:"refresher-already-running",message:"The token refresher is already running. You must wait until is has finished before submitting a new token."},ye={status:Dt,error:"already-signed-in",message:"User is already signed in"},Ws={status:Dt,error:"unauthenticated-user",message:"User is not authenticated"},Qs={status:Dt,error:"unverified-user",message:"Email needs verification"},Xs={status:me,error:"invalid-refresh-token",message:"Invalid or expired refresh token"},Zs={status:kn,error:"invalid-sign-in-method",message:"Invalid sign-in method"},yr={user:null,mfa:null,accessToken:{value:null,expiresAt:null,expiresInSeconds:15},refreshTimer:{startedAt:null,attempts:0,lastAttempt:null},refreshToken:{value:null},importTokenAttempts:0,errors:{}};function eo(t){return new TextEncoder().encode(t)}function Se(t){const e=new Uint8Array(t);let r="";for(const n of e)r+=String.fromCharCode(n);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function gr(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4,n=e.padEnd(e.length+r,"="),i=atob(n),s=new ArrayBuffer(i.length),o=new Uint8Array(s);for(let d=0;d<i.length;d++)o[d]=i.charCodeAt(d);return s}function _n(){return(window==null?void 0:window.PublicKeyCredential)!==void 0&&typeof window.PublicKeyCredential=="function"}function Nn(t){const{id:e}=t;return{...t,id:gr(e),transports:t.transports}}function Rn(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}let ce=class extends Error{constructor({message:e,code:r,cause:n,name:i}){super(e,{cause:n}),this.name=i!=null?i:n.name,this.code=r}};function to({error:t,options:e}){var r,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ce({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)==null?void 0:r.requireResidentKey)===!0)return new ce({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(((n=i.authenticatorSelection)==null?void 0:n.userVerification)==="required")return new ce({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new ce({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new ce({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(s=>s.type==="public-key").length===0?new ce({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new ce({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Rn(s)){if(i.rp.id!==s)return new ce({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ce({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new ce({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new ce({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return t}class ro{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Dn=new ro,no=["cross-platform","platform"];function Cn(t){if(t&&!(no.indexOf(t)<0))return t}async function Pn(t){var e;if(!_n())throw new Error("WebAuthn is not supported in this browser");const r={publicKey:{...t,challenge:gr(t.challenge),user:{...t.user,id:eo(t.user.id)},excludeCredentials:(e=t.excludeCredentials)==null?void 0:e.map(Nn)}};r.signal=Dn.createNewAbortSignal();let n;try{n=await navigator.credentials.create(r)}catch(h){throw to({error:h,options:r})}if(!n)throw new Error("Registration was not completed");const{id:i,rawId:s,response:o,type:d}=n;let u;typeof o.getTransports=="function"&&(u=o.getTransports());let l;if(typeof o.getPublicKeyAlgorithm=="function")try{l=o.getPublicKeyAlgorithm()}catch(h){Er("getPublicKeyAlgorithm()",h)}let a;if(typeof o.getPublicKey=="function")try{const h=o.getPublicKey();h!==null&&(a=Se(h))}catch(h){Er("getPublicKey()",h)}let c;if(typeof o.getAuthenticatorData=="function")try{c=Se(o.getAuthenticatorData())}catch(h){Er("getAuthenticatorData()",h)}return{id:i,rawId:Se(s),response:{attestationObject:Se(o.attestationObject),clientDataJSON:Se(o.clientDataJSON),transports:u,publicKeyAlgorithm:l,publicKey:a,authenticatorData:c},type:d,clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:Cn(n.authenticatorAttachment)}}function Er(t,e){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${t}. You should report this error to them.
`,e)}function io(t){return new TextDecoder("utf-8").decode(t)}function so(){const t=window.PublicKeyCredential;return t.isConditionalMediationAvailable===void 0?new Promise(e=>e(!1)):t.isConditionalMediationAvailable()}function oo({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ce({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new ce({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(Rn(n)){if(r.rpId!==n)return new ce({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ce({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new ce({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return t}async function Ln(t,e=!1){var r,n;if(!_n())throw new Error("WebAuthn is not supported in this browser");let i;((r=t.allowCredentials)==null?void 0:r.length)!==0&&(i=(n=t.allowCredentials)==null?void 0:n.map(Nn));const s={...t,challenge:gr(t.challenge),allowCredentials:i},o={};if(e){if(!await so())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');o.mediation="conditional",s.allowCredentials=[]}o.publicKey=s,o.signal=Dn.createNewAbortSignal();let d;try{d=await navigator.credentials.get(o)}catch(f){throw oo({error:f,options:o})}if(!d)throw new Error("Authentication was not completed");const{id:u,rawId:l,response:a,type:c}=d;let h;return a.userHandle&&(h=io(a.userHandle)),{id:u,rawId:Se(l),response:{authenticatorData:Se(a.authenticatorData),clientDataJSON:Se(a.clientDataJSON),signature:Se(a.signature),userHandle:h},type:c,clientExtensionResults:d.getClientExtensionResults(),authenticatorAttachment:Cn(d.authenticatorAttachment)}}const Ct=typeof window!="undefined",Pt=new Map,ao=t=>{var e;return Ct&&typeof localStorage!="undefined"?localStorage.getItem(t):(e=Pt.get(t))!=null?e:null},co=(t,e)=>{Ct&&typeof localStorage!="undefined"?e?localStorage.setItem(t,e):localStorage.removeItem(t):e?Pt.set(t,e):Pt.has(t)&&Pt.delete(t)},uo=(t,e)=>{if(t==="localStorage"||t==="web")return ao;if(t==="cookie")return r=>{var n;return Ct&&(n=dr.get(r))!=null?n:null};if(!e)throw Error(`clientStorageType is set to '${t}' but no clientStorage has been given`);if(t==="react-native")return r=>{var n;return(n=e.getItem)==null?void 0:n.call(e,r)};if(t==="capacitor")return r=>{var n;return(n=e.get)==null?void 0:n.call(e,{key:r})};if(t==="expo-secure-storage")return r=>{var n;return(n=e.getItemAsync)==null?void 0:n.call(e,r)};if(t==="custom"){if(e.getItem&&e.removeItem)return e.getItem;if(e.getItemAsync)return e.getItemAsync;throw Error(`clientStorageType is set to 'custom' but clientStorage is missing either "getItem" and "removeItem" properties or "getItemAsync" property`)}throw Error(`Unknown storage type: ${t}`)},lo=(t,e)=>{if(t==="localStorage"||t==="web")return co;if(t==="cookie")return(r,n)=>{Ct&&(n?dr.set(r,n,{expires:30,sameSite:"lax",httpOnly:!1}):dr.remove(r))};if(!e)throw Error(`clientStorageType is set to '${t}' but no clienStorage has been given`);if(t==="react-native")return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(t==="capacitor")return(r,n)=>{var i,s;return n?(i=e.set)==null?void 0:i.call(e,{key:r,value:n}):(s=e.remove)==null?void 0:s.call(e,{key:r})};if(t==="expo-secure-storage")return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.deleteItemAsync)==null?void 0:s.call(e,r)};if(t==="custom"){if(!e.removeItem)throw Error("clientStorageType is set to 'custom' but clientStorage is missing a removeItem property");if(e.setItem)return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(e.setItemAsync)return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};throw Error("clientStorageType is set to 'custom' but clientStorage is missing setItem or setItemAsync property")}throw Error(`Unknown storage type: ${t}`)},Lt=t=>!t||!t.accessToken.value||!t.accessToken.expiresAt||!t.user?null:{accessToken:t.accessToken.value,accessTokenExpiresIn:(t.accessToken.expiresAt.getTime()-Date.now())/1e3,refreshToken:t.refreshToken.value,user:t.user},ke=({accessToken:t,refreshToken:e,isError:r,user:n,error:i})=>r?{session:null,error:i}:n&&t?{session:{accessToken:t,accessTokenExpiresIn:0,refreshToken:e,user:n},error:null}:{session:null,error:null},Un=()=>typeof window!="undefined"&&typeof window.location!="undefined";let Mn=globalThis.fetch;typeof EdgeRuntime!="string"&&(Mn=vr().fetch);const jn=async(t,e,{token:r,body:n}={})=>{const i={"Content-Type":"application/json",Accept:"*/*"};r&&(i.Authorization=`Bearer ${r}`);const s={method:e,headers:i};n&&(s.body=JSON.stringify(n));try{const o=await Mn(t,s);if(!o.ok){const d=await o.json();return Promise.reject({error:d})}try{return{data:await o.json(),error:null}}catch{return console.warn(`Unexpected response: can't parse the response of the server at ${t}`),{data:"OK",error:null}}}catch{const o={message:"Network Error",status:bn,error:"network"};return Promise.reject({error:o})}},fe=async(t,e,r)=>jn(t,"POST",{token:r,body:e}),ho=(t,e)=>jn(t,"GET",{token:e}),Ut=(t,e)=>{const r=e&&Object.entries(e).map(([n,i])=>{const s=Array.isArray(i)?i.join(","):typeof i=="object"?JSON.stringify(i):i;return`${n}=${encodeURIComponent(s)}`}).join("&");return r?`${t}?${r}`:t},le=(t,e)=>{if(!(e!=null&&e.redirectTo))return e;const{redirectTo:r,...n}=e;if(!t)return r.startsWith("/")?n:e;const i=new URL(t),s=Object.fromEntries(new URLSearchParams(i.search)),o=new URL(r.startsWith("/")?i.origin+r:r),d=new URLSearchParams(o.search);let u=Object.fromEntries(d);r.startsWith("/")&&(u={...s,...u});let l=i.pathname;return o.pathname.length>1&&(l+=o.pathname.slice(1)),{...n,redirectTo:Ut(o.origin+l,u)}};function Mt(t,e){var r;if(!e){if(typeof window=="undefined")return;e=((r=window.location)==null?void 0:r.href)||""}t=t.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&#]"+t+"(=([^&#]*)|&|#|$)"),i=n.exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function Fn(t){var e;if(typeof window=="undefined")return;const r=window==null?void 0:window.location;if(r&&r){const n=new URLSearchParams(r.search),i=new URLSearchParams((e=r.hash)==null?void 0:e.slice(1));n.delete(t),i.delete(t);let s=window.location.pathname;Array.from(n).length&&(s+=`?${n.toString()}`),Array.from(i).length&&(s+=`#${i.toString()}`),window.history.pushState({},"",s)}}const Ie=t=>!!t&&typeof t=="string"&&!!String(t).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),Tr=t=>!!t&&typeof t=="string"&&t.length>=Gs,Vn=t=>!!t&&typeof t=="string",fo=t=>t&&typeof t=="string"&&t.match(/^mfaTotp:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),po=({backendUrl:t,clientUrl:e,clientStorageType:r="web",clientStorage:n,refreshIntervalTime:i,autoRefreshToken:s=!0,autoSignIn:o=!0})=>{const d=uo(r,n),u=lo(r,n),l=async(a,c,h)=>(await fe(`${t}${a}`,c,h)).data;return Oe({schema:{context:{},events:{},services:{}},tsTypes:{},context:yr,predictableActionArguments:!0,id:"nhost",type:"parallel",states:{authentication:{initial:"starting",on:{SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","resetTimer","reportTokenChanged"],target:".signedIn"}]},states:{starting:{tags:["loading"],always:{cond:"isSignedIn",target:"signedIn"},invoke:{id:"importRefreshToken",src:"importRefreshToken",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"signedIn"},{target:"signedOut"}],onError:[{cond:"shouldRetryImportToken",actions:"incrementTokenImportAttempts",target:"retryTokenImport"},{actions:["saveAuthenticationError"],target:"signedOut"}]}},retryTokenImport:{tags:["loading"],after:{RETRY_IMPORT_TOKEN_DELAY:"starting"}},signedOut:{initial:"noErrors",entry:"reportSignedOut",states:{noErrors:{},success:{},needsSmsOtp:{},needsMfa:{},failed:{},signingOut:{entry:["clearContextExceptRefreshToken"],exit:["destroyRefreshToken","reportTokenChanged"],invoke:{src:"signout",id:"signingOut",onDone:{target:"success"},onError:{target:"failed",actions:["saveAuthenticationError"]}}}},on:{SIGNIN_PASSWORD:"authenticating.password",SIGNIN_ANONYMOUS:"authenticating.anonymous",SIGNIN_SECURITY_KEY_EMAIL:"authenticating.securityKeyEmail",SIGNIN_MFA_TOTP:"authenticating.mfa.totp",SIGNIN_PAT:"authenticating.pat"}},authenticating:{entry:"resetErrors",states:{password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:[{cond:"hasMfaTicket",actions:["saveMfaTicket"],target:"#nhost.authentication.signedOut.needsMfa"},{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"}],onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},pat:{invoke:{src:"signInPAT",id:"authenticateWithPAT",onDone:{actions:["savePATSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},mfa:{states:{totp:{invoke:{src:"signInMfaTotp",id:"signInMfaTotp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:["saveAuthenticationError"],target:"#nhost.authentication.signedOut.failed"}}}}},securityKeyEmail:{invoke:{src:"signInSecurityKeyEmail",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}}}},signedIn:{type:"parallel",entry:["reportSignedIn","cleanUrl","broadcastToken","resetErrors"],on:{SIGNOUT:"signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"isRefreshTokenPAT",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{1e3:{internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","resetTimer","reportTokenChanged"],target:"pending"},onError:[{actions:"saveRefreshAttempt",target:"pending"}]}}}}}}}}}},token:{initial:"idle",states:{idle:{on:{TRY_TOKEN:"running"},initial:"noErrors",states:{noErrors:{},error:{}}},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","reportTokenChanged"],target:["#nhost.authentication.signedIn","idle.noErrors"]},onError:[{cond:"isSignedIn",target:"idle.error"},{actions:"saveAuthenticationError",target:["#nhost.authentication.signedOut.failed","idle.error"]}]}}}},registration:{initial:"incomplete",on:{SIGNED_IN:[{cond:"isAnonymous",target:".incomplete"},".complete"]},states:{incomplete:{on:{SIGNUP_EMAIL_PASSWORD:"emailPassword",SIGNUP_SECURITY_KEY:"securityKey",PASSWORDLESS_EMAIL:"passwordlessEmail",PASSWORDLESS_SMS:"passwordlessSms",PASSWORDLESS_SMS_OTP:"passwordlessSmsOtp"},initial:"noErrors",states:{noErrors:{},needsEmailVerification:{},needsOtp:{},failed:{}}},emailPassword:{entry:["resetErrors"],invoke:{src:"signUpEmailPassword",id:"signUpEmailPassword",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},securityKey:{entry:["resetErrors"],invoke:{src:"signUpSecurityKey",id:"signUpSecurityKey",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},passwordlessEmail:{entry:["resetErrors"],invoke:{src:"passwordlessEmail",id:"passwordlessEmail",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSms:{entry:["resetErrors"],invoke:{src:"passwordlessSms",id:"passwordlessSms",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSmsOtp:{entry:["resetErrors"],invoke:{src:"passwordlessSmsOtp",id:"passwordlessSmsOtp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},complete:{on:{SIGNED_OUT:"incomplete"}}}}}},{actions:{reportSignedIn:se("SIGNED_IN"),reportSignedOut:se("SIGNED_OUT"),reportTokenChanged:se("TOKEN_CHANGED"),incrementTokenImportAttempts:M({importTokenAttempts:({importTokenAttempts:a})=>a+1}),clearContext:M(()=>(u(Ye,null),u(He,null),u(Rt,null),{...yr})),clearContextExceptRefreshToken:M(({refreshToken:{value:a}})=>(u(Ye,null),{...yr,refreshToken:{value:a}})),saveSession:M({user:(a,{data:c})=>{var h;return((h=c==null?void 0:c.session)==null?void 0:h.user)||null},accessToken:(a,{data:c})=>{if(c.session){const{accessTokenExpiresIn:h,accessToken:f}=c.session,p=new Date(Date.now()+h*1e3);return u(Ye,p.toISOString()),{value:f,expiresAt:p,expiresInSeconds:h}}return u(Ye,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(a,{data:c})=>{var h,f;const p=((h=c.session)==null?void 0:h.refreshToken)||null,m=((f=c.session)==null?void 0:f.refreshTokenId)||null;return p&&u(He,p),m&&u(Rt,m),{value:p}}}),savePATSession:M({user:(a,{data:c})=>{var h;return((h=c==null?void 0:c.session)==null?void 0:h.user)||null},accessToken:(a,{data:c})=>{if(c.session){const{accessTokenExpiresIn:h,accessToken:f}=c.session,p=new Date(Date.now()+h*1e3);return u(Ye,p.toISOString()),{value:f,expiresAt:p,expiresInSeconds:h}}return u(Ye,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(a,{data:c})=>{var h,f;const p=((h=c.session)==null?void 0:h.refreshToken)||null,m=((f=c.session)==null?void 0:f.refreshTokenId)||null;return p&&u(He,p),m&&u(Rt,m),{value:p,isPAT:!0}}}),saveMfaTicket:M({mfa:(a,c)=>{var h;return(h=c.data)==null?void 0:h.mfa}}),resetTimer:M({refreshTimer:a=>({startedAt:new Date,attempts:0,lastAttempt:null})}),saveRefreshAttempt:M({refreshTimer:(a,c)=>({startedAt:a.refreshTimer.startedAt,attempts:a.refreshTimer.attempts+1,lastAttempt:new Date})}),saveAuthenticationError:M({errors:({errors:a},{data:{error:c}})=>({...a,authentication:c})}),resetErrors:M({errors:a=>({}),importTokenAttempts:a=>0}),saveRegistrationError:M({errors:({errors:a},{data:{error:c}})=>({...a,registration:c})}),destroyRefreshToken:M({refreshToken:a=>(u(He,null),u(Rt,null),{value:null})}),cleanUrl:()=>{o&&Mt("refreshToken")&&(Fn("refreshToken"),Fn("type"))},broadcastToken:a=>{if(o)try{new BroadcastChannel("nhost").postMessage({type:"broadcast_token",payload:{token:a.refreshToken.value}})}catch{}}},guards:{isAnonymous:(a,c)=>{var h;return!!((h=a.user)!=null&&h.isAnonymous)},isSignedIn:a=>!!a.user&&!!a.accessToken.value,noToken:a=>!a.refreshToken.value,isRefreshTokenPAT:a=>{var c;return!!((c=a.refreshToken)!=null&&c.isPAT)},hasRefreshToken:a=>!!a.refreshToken.value,isAutoRefreshDisabled:()=>!s,refreshTimerShouldRefresh:a=>{const{expiresAt:c}=a.accessToken;if(!c)return!1;if(a.refreshTimer.lastAttempt)return a.refreshTimer.attempts>On?!1:Date.now()-a.refreshTimer.lastAttempt.getTime()>Math.pow(2,a.refreshTimer.attempts-1)*5e3;if(c.getTime()<Date.now()||i&&Date.now()-a.refreshTimer.startedAt.getTime()>i*1e3)return!0;const h=a.accessToken.expiresInSeconds;return h?c.getTime()-Date.now()-1e3*Math.min(Hs,h*.5)<=0:!1},shouldRetryImportToken:(a,c)=>a.importTokenAttempts<On&&(c.data.error.status===bn||c.data.error.status>=500),unverified:(a,{data:{error:c}})=>c.status===401&&(c.message==="Email is not verified"||c.error==="unverified-user"),hasSession:(a,c)=>{var h;return!!((h=c.data)!=null&&h.session)},hasMfaTicket:(a,c)=>{var h;return!!((h=c.data)!=null&&h.mfa)}},services:{signInPassword:(a,{email:c,password:h})=>Ie(c)?Tr(h)?l("/signin/email-password",{email:c,password:h}):Promise.reject({error:mr}):Promise.reject({error:be}),signInPAT:(a,{pat:c})=>l("/signin/pat",{personalAccessToken:c}),passwordlessSms:(a,{phoneNumber:c,options:h})=>{var f;return Vn(c)?(f=a.user)!=null&&f.isAnonymous?(console.warn("Deanonymisation from a phone number is not yet implemented in hasura-auth"),l("/user/deanonymize",{signInMethod:"passwordless",connection:"sms",phoneNumber:c,options:le(e,h)},a.accessToken.value)):l("/signin/passwordless/sms",{phoneNumber:c,options:le(e,h)}):Promise.reject({error:In})},passwordlessSmsOtp:(a,{phoneNumber:c,otp:h})=>Vn(c)?l("/signin/passwordless/sms/otp",{phoneNumber:c,otp:h}):Promise.reject({error:In}),passwordlessEmail:(a,{email:c,options:h})=>{var f;return Ie(c)?(f=a.user)!=null&&f.isAnonymous?l("/user/deanonymize",{signInMethod:"passwordless",connection:"email",email:c,options:le(e,h)},a.accessToken.value):l("/signin/passwordless/email",{email:c,options:le(e,h)}):Promise.reject({error:be})},signInAnonymous:a=>l("/signin/anonymous"),signInMfaTotp:(a,c)=>{var h;const f=c.ticket||((h=a.mfa)==null?void 0:h.ticket);return f?fo(f)?l("/signin/mfa/totp",{ticket:f,otp:c.otp}):Promise.reject({error:qs}):Promise.reject({error:$s})},signInSecurityKeyEmail:async(a,{email:c})=>{if(!Ie(c))throw new at(be);const h=await l("/signin/webauthn",{email:c});let f;try{f=await Ln(h)}catch(p){throw new at(p)}return l("/signin/webauthn/verify",{email:c,credential:f})},refreshToken:async(a,c)=>{const h=c.type==="TRY_TOKEN"?c.token:a.refreshToken.value;return{session:await l("/token",{refreshToken:h}),error:null}},signout:async(a,c)=>{const h=await l("/signout",{refreshToken:a.refreshToken.value,all:!!c.all});try{new BroadcastChannel("nhost").postMessage({type:"signout"})}catch{}return h},signUpEmailPassword:async(a,{email:c,password:h,options:f})=>{var p;return Ie(c)?Tr(h)?(p=a.user)!=null&&p.isAnonymous?l("/user/deanonymize",{signInMethod:"email-password",email:c,password:h,options:le(e,f)},a.accessToken.value):l("/signup/email-password",{email:c,password:h,options:le(e,f)}):Promise.reject({error:mr}):Promise.reject({error:be})},signUpSecurityKey:async(a,{email:c,options:h})=>{if(!Ie(c))return Promise.reject({error:be});const f=h==null?void 0:h.nickname;f&&delete h.nickname;const p=await l("/signup/webauthn",{email:c,options:h});let m;try{m=await Pn(p)}catch(O){throw new at(O)}return l("/signup/webauthn/verify",{credential:m,options:{redirectTo:h==null?void 0:h.redirectTo,nickname:f}})},importRefreshToken:async a=>{if(a.user&&a.refreshToken.value&&a.accessToken.value&&a.accessToken.expiresAt)return{session:{accessToken:a.accessToken.value,accessTokenExpiresIn:a.accessToken.expiresAt.getTime()-Date.now(),refreshToken:a.refreshToken.value,user:a.user},error:null};let c=null;if(o){const f=Mt("refreshToken")||null;if(f)try{return{session:await l("/token",{refreshToken:f}),error:null}}catch(p){c=p.error}else{const p=Mt("error"),m=Mt("errorDescription");if(p&&m!=="social user already exists")return Promise.reject({session:null,error:{status:me,error:p,message:m||p}})}}const h=await d(He);if(h)try{return{session:await l("/token",{refreshToken:h}),error:null}}catch(f){c=f.error}return c?Promise.reject({error:c,session:null}):{error:null,session:null}}},delays:{RETRY_IMPORT_TOKEN_DELAY:({importTokenAttempts:a})=>Math.pow(2,a-1)*5e3}})},Bn=({backendUrl:t,clientUrl:e,interpreter:r})=>Oe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:M({error:n=>be}),saveRequestError:M({error:(n,{data:{error:i}})=>i}),reportError:se(n=>({type:"ERROR",error:n.error})),reportSuccess:se("SUCCESS")},guards:{invalidEmail:(n,{email:i})=>!Ie(i)},services:{requestChange:async(n,{email:i,options:s})=>(await fe(`${t}/user/email/change`,{newEmail:i,options:le(e,s)},r==null?void 0:r.getSnapshot().context.accessToken.value)).data}}),Gn=({backendUrl:t,interpreter:e})=>Oe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:M({error:r=>mr}),saveRequestError:M({error:(r,{data:{error:n}})=>n}),reportError:se(r=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS")},guards:{invalidPassword:(r,{password:n})=>!Tr(n)},services:{requestChange:(r,{password:n,ticket:i})=>fe(`${t}/user/password`,{newPassword:n,ticket:i},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),vo=({backendUrl:t,interpreter:e})=>Oe({schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,id:"enableMfa",initial:"idle",context:{error:null,imageUrl:null,secret:null},states:{idle:{initial:"initial",on:{GENERATE:"generating"},states:{initial:{},error:{}}},generating:{invoke:{src:"generate",id:"generate",onDone:{target:"generated",actions:["reportGeneratedSuccess","saveGeneration"]},onError:{actions:["saveError","reportGeneratedError"],target:"idle.error"}}},generated:{initial:"idle",states:{idle:{initial:"idle",on:{ACTIVATE:[{cond:"invalidMfaType",actions:"saveInvalidMfaTypeError",target:".error"},{cond:"invalidMfaCode",actions:"saveInvalidMfaCodeError",target:".error"},{target:"activating"}]},states:{idle:{},error:{}}},activating:{invoke:{src:"activate",id:"activate",onDone:{target:"activated",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}},activated:{type:"final"}}}}},{actions:{saveInvalidMfaTypeError:M({error:r=>Ys}),saveInvalidMfaCodeError:M({error:r=>Ks}),saveError:M({error:(r,{data:{error:n}})=>n}),saveGeneration:M({imageUrl:(r,{data:{imageUrl:n}})=>n,secret:(r,{data:{totpSecret:n}})=>n}),reportError:se((r,n)=>(console.log("REPORT",r,n),{type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS"),reportGeneratedSuccess:se("GENERATED"),reportGeneratedError:se(r=>({type:"GENERATED_ERROR",error:r.error}))},guards:{invalidMfaCode:(r,{code:n})=>!n,invalidMfaType:(r,{activeMfaType:n})=>!n||n!=="totp"},services:{generate:async r=>{const{data:n}=await ho(`${t}/mfa/totp/generate`,e==null?void 0:e.getSnapshot().context.accessToken.value);return n},activate:(r,{code:n,activeMfaType:i})=>fe(`${t}/user/mfa`,{code:n,activeMfaType:i},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),Hn=({backendUrl:t,clientUrl:e})=>Oe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:M({error:r=>be}),saveRequestError:M({error:(r,{data:{error:n}})=>n}),reportError:se(r=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!Ie(n)},services:{requestChange:(r,{email:n,options:i})=>fe(`${t}/user/password/reset`,{email:n,options:le(e,i)})}}),Yn=({backendUrl:t,clientUrl:e})=>Oe({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"sendVerificationEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"request",id:"request",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:M({error:r=>be}),saveRequestError:M({error:(r,{data:{error:n}})=>n}),reportError:se(r=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!Ie(n)},services:{request:async(r,{email:n,options:i})=>(await fe(`${t}/user/email/send-verification-email`,{email:n,options:le(e,i)})).data}});class mo{constructor({clientStorageType:e="web",autoSignIn:r=!0,autoRefreshToken:n=!0,start:i=!0,backendUrl:s,clientUrl:o,devTools:d,...u}){var l;if(this._started=!1,this._subscriptionsQueue=new Set,this._subscriptions=new Set,this.backendUrl=s,this.clientUrl=o,this._machine=po({...u,backendUrl:s,clientUrl:o,clientStorageType:e,autoSignIn:r,autoRefreshToken:n}),i&&this.start({devTools:d}),typeof window!="undefined")try{this._channel=new BroadcastChannel("nhost"),r&&((l=this._channel)==null||l.addEventListener("message",a=>{var c;const{type:h,payload:f}=a.data;if(h==="broadcast_token"){const p=(c=this.interpreter)==null?void 0:c.getSnapshot().context.refreshToken.value;this.interpreter&&f.token&&f.token!==p&&this.interpreter.send("TRY_TOKEN",{token:f.token})}})),this._channel.addEventListener("message",a=>{const{type:c}=a.data;c==="signout"&&this.interpreter&&this.interpreter.send("SIGNOUT")})}catch{}}start({devTools:e=!1,initialSession:r,interpreter:n}={}){var i,s;const o={...this.machine.context,accessToken:{...this.machine.context.accessToken},refreshToken:{...this.machine.context.refreshToken}};r&&(o.user=r.user,o.refreshToken.value=(i=r.refreshToken)!=null?i:null,o.accessToken.value=(s=r.accessToken)!=null?s:null,o.accessToken.expiresAt=new Date(Date.now()+r.accessTokenExpiresIn*1e3));const d=this.machine.withContext(o);this._interpreter||(this._interpreter=n||De(d,{devTools:e})),(!this._started||typeof window=="undefined")&&(this._interpreter.initialized&&(this._interpreter.stop(),this._subscriptions.forEach(u=>u())),this._interpreter.start(d.initialState),this._subscriptionsQueue.forEach(u=>u(this))),this._started=!0}get machine(){return this._machine}get interpreter(){return this._interpreter}get started(){return this._started}subscribe(e){if(this.started){const r=e(this);return this._subscriptions.add(r),r}else return this._subscriptionsQueue.add(e),()=>{console.log("onTokenChanged was added before the interpreter started. Cannot unsubscribe listener.")}}}const Kn=async({backendUrl:t,interpreter:e},r)=>{try{const{data:n}=await fe(`${t}/user/webauthn/add`,{},e==null?void 0:e.getSnapshot().context.accessToken.value);let i;try{i=await Pn(n)}catch(o){throw new at(o)}const{data:s}=await fe(`${t}/user/webauthn/verify`,{credential:i,nickname:r},e==null?void 0:e.getSnapshot().context.accessToken.value);return{key:s,isError:!1,error:null,isSuccess:!0}}catch(n){const{error:i}=n;return{isError:!0,error:i,isSuccess:!1}}},qn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,needsEmailVerification:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,needsEmailVerification:!0})})}),$n=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{password:e,ticket:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSuccess:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSuccess:!0})})}),yo=t=>new Promise(e=>{t.send("GENERATE"),t.onTransition(r=>{r.matches("generated")?e({error:null,isError:!1,isGenerated:!0,qrCodeDataUrl:r.context.imageUrl||""}):r.matches({idle:"error"})&&e({error:r.context.error||null,isError:!0,isGenerated:!1,qrCodeDataUrl:""})})}),go=(t,e)=>new Promise(r=>{t.send("ACTIVATE",{activeMfaType:"totp",code:e}),t.onTransition(n=>{n.matches({generated:"activated"})?r({error:null,isActivated:!0,isError:!1}):n.matches({generated:{idle:"error"}})&&r({error:n.context.error,isActivated:!1,isError:!0})})}),zn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),Jn=(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),Wn=t=>new Promise(e=>{const{changed:r}=t.send("SIGNIN_ANONYMOUS");r||e({isSuccess:!1,isError:!0,error:ye,user:null,accessToken:null,refreshToken:null}),t.onTransition(n=>{n.matches({authentication:"signedIn"})&&e({isSuccess:!0,isError:!1,error:null,user:n.context.user,accessToken:n.context.accessToken.value,refreshToken:n.context.refreshToken.value}),n.matches({authentication:{signedOut:"failed"}})&&e({isSuccess:!1,isError:!0,error:n.context.errors.authentication||null,user:null,accessToken:null,refreshToken:null})})}),Qn=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_PASSWORD",{email:e,password:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:ye,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:{signedOut:"needsMfa"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!0,mfa:o.context.mfa,user:null}):o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:o.context.user})})}),Sr=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_EMAIL",{email:e,options:r});if(!i)return n({error:ye,isError:!0,isSuccess:!1});t.onTransition(s=>{s.matches("registration.incomplete.failed")?n({error:s.context.errors.registration||null,isError:!0,isSuccess:!1}):s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})&&n({error:null,isError:!1,isSuccess:!0})})}),Xn=(t,e)=>new Promise(r=>{const{changed:n,context:i}=t.send({type:"SIGNIN_SECURITY_KEY_EMAIL",email:e});if(!n)return r({accessToken:i.accessToken.value,refreshToken:i.refreshToken.value,error:ye,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:i.user});t.onTransition(s=>{s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?r({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):s.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,refreshToken:null,error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):s.matches({authentication:"signedIn"})&&r({accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:s.context.user})})}),Zn=(t,e)=>new Promise(async r=>{var n,i;const s=(n=t.interpreter)==null?void 0:n.getSnapshot(),o=s==null?void 0:s.context.accessToken.value,{data:d}=await fe(`${t.backendUrl}/elevate/webauthn`,{email:e},o);let u;try{u=await Ln(d)}catch(l){throw new at(l)}try{const{data:{session:l},error:a}=await fe(`${t.backendUrl}/elevate/webauthn/verify`,{email:e,credential:u},o);l&&!a&&((i=t.interpreter)==null||i.send({type:"SESSION_UPDATE",data:{session:l}}),r({error:null,isError:!1,isSuccess:!0,elevated:!0}))}catch(l){const{error:a}=l;r({error:a,isError:!0,isSuccess:!1,elevated:!1})}}),ei=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_MFA_TOTP",{otp:e,ticket:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:ye,isError:!0,isSuccess:!1,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,user:o.context.user})})}),ti=(t,e)=>new Promise(r=>{const{changed:n}=t.send("SIGNIN_PAT",{pat:e});n||r({isSuccess:!1,isError:!0,error:ye,user:null,accessToken:null,refreshToken:null}),t.onTransition(i=>{if(i.matches({authentication:{signedOut:"failed"}}))return r({accessToken:null,refreshToken:null,user:null,error:i.context.errors.authentication||null,isError:!0,isSuccess:!1});if(i.matches({authentication:"signedIn"}))return r({accessToken:i.context.accessToken.value,refreshToken:i.context.refreshToken.value,user:i.context.user,error:null,isError:!1,isSuccess:!0})})}),wr=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_SMS",{phoneNumber:e,options:r});if(!i)return n({error:ye,isError:!0,isSuccess:!1,needsOtp:!1});t.onTransition(s=>{s.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!1,needsOtp:!0}):s.matches("registration.incomplete.failed")&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),xr=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send({type:"PASSWORDLESS_SMS_OTP",phoneNumber:e,otp:r});if(!i)return n({error:ye,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});t.onTransition(s=>{s.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:s.context.user,accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value}):s.matches({registration:{incomplete:"failed"}})&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),ri=async(t,e)=>new Promise(r=>{const{event:n}=t.send("SIGNOUT",{all:e});if(n.type!=="SIGNED_OUT")return r({isSuccess:!1,isError:!0,error:Ws});t.onTransition(i=>{i.matches({authentication:{signedOut:"success"}})?r({isSuccess:!0,isError:!1,error:null}):i.matches("authentication.signedOut.failed")&&r({isSuccess:!1,isError:!0,error:i.context.errors.signout||null})})}),Ar=(t,e,r,n)=>new Promise(i=>{const{changed:s,context:o}=t.send("SIGNUP_EMAIL_PASSWORD",{email:e,password:r,options:n});if(!s)return i({error:ye,accessToken:o.accessToken.value,refreshToken:o.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:o.user});t.onTransition(d=>{d.matches("registration.incomplete.failed")?i({accessToken:null,refreshToken:null,error:d.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):d.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?i({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):d.matches({authentication:"signedIn",registration:"complete"})&&i({accessToken:d.context.accessToken.value,refreshToken:d.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:d.context.user})})}),ni=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNUP_SECURITY_KEY",{email:e,options:r});if(!i)return n({error:ye,accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:s.user});t.onTransition(o=>{o.matches("registration.incomplete.failed")?n({accessToken:null,refreshToken:null,error:o.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):o.matches({authentication:"signedIn",registration:"complete"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:o.context.user})})}),Eo=async({backendUrl:t,interpreter:e},{expiresAt:r,metadata:n})=>{try{const{data:i}=await fe(`${t}/pat`,{expiresAt:r.toISOString(),metadata:n},e==null?void 0:e.getSnapshot().context.accessToken.value);return{data:i?{id:i.id||null,personalAccessToken:i.personalAccessToken||null}:null,isError:!1,error:null,isSuccess:!0}}catch(i){const{error:s}=i;return{isError:!0,error:s,isSuccess:!1,data:null}}};class To{constructor({url:e,autoRefreshToken:r=!0,autoSignIn:n=!0,clientStorage:i,clientStorageType:s,refreshIntervalTime:o,start:d=!0}){var u;this.url=e,this._client=new mo({backendUrl:e,clientUrl:typeof window!="undefined"&&((u=window.location)==null?void 0:u.origin)||"",autoRefreshToken:r,autoSignIn:n,start:d,clientStorage:i,clientStorageType:s,refreshIntervalTime:o})}async signUp(e){const r=await this.waitUntilReady(),{email:n,options:i}=e;return"securityKey"in e?ke(await ni(r,n,i)):ke(await Ar(r,n,e.password,i))}async connectProvider(e){const r=(await this.waitUntilReady()).getSnapshot().context.accessToken.value,{provider:n,options:i}=e,s=Ut(`${this._client.backendUrl}/signin/provider/${n}`,le(this._client.clientUrl,{...i,connect:r}));return Un()&&(window.location.href=s),{providerUrl:s}}async signIn(e){const r=await this.waitUntilReady();if(!e){const n=await Wn(r);return{...ke(n),mfa:null}}if("provider"in e){const{provider:n,options:i}=e,s=Ut(`${this._client.backendUrl}/signin/provider/${n}`,le(this._client.clientUrl,i));return Un()&&(window.location.href=s),{providerUrl:s,provider:n,session:null,mfa:null,error:null}}if("email"in e&&"password"in e){const n=await Qn(r,e.email,e.password);return n.needsEmailVerification?{session:null,mfa:null,error:Qs}:n.needsMfaOtp?{session:null,mfa:n.mfa,error:null}:{...ke(n),mfa:null}}if("email"in e&&"securityKey"in e){if(e.securityKey!==!0)throw Error("securityKey must be true");const n=await Xn(r,e.email);return{...ke(n),mfa:null}}if("email"in e){const{email:n,options:i}=e,{error:s}=await Sr(r,n,i);return{session:null,mfa:null,error:s}}if("phoneNumber"in e&&"otp"in e){const n=await xr(r,e.phoneNumber,e.otp);return{...ke(n),mfa:null}}if("phoneNumber"in e){const{error:n}=await wr(r,e.phoneNumber,e.options);return{error:n,mfa:null,session:null}}if("otp"in e){const n=await ei(r,e.otp,e.ticket);return{...ke(n),mfa:null}}return{error:Zs,mfa:null,session:null}}async signInPAT(e){const r=await this.waitUntilReady(),n=await ti(r,e);return ke(n)}async signOut(e){const r=await this.waitUntilReady(),{error:n}=await ri(r,e==null?void 0:e.all);return{error:n}}async resetPassword({email:e,options:r}){const n=De(Hn(this._client)).start(),{error:i}=await zn(n,e,r);return{error:i}}async changePassword({newPassword:e,ticket:r}){const n=De(Gn(this._client)).start(),{error:i}=await $n(n,e,r);return{error:i}}async sendVerificationEmail({email:e,options:r}){const n=De(Yn(this._client)).start(),{error:i}=await Jn(n,e,r);return{error:i}}async changeEmail({newEmail:e,options:r}){const n=De(Bn(this._client)).start(),{error:i}=await qn(n,e,r);return{error:i}}async deanonymize(e){const r=await this.waitUntilReady();if(e.signInMethod==="passwordless"){if(e.connection==="email"){const{error:n}=await Sr(r,e.email,e.options);return{error:n}}if(e.connection==="sms"){const{error:n}=await wr(r,e.phoneNumber,e.options);return{error:n}}}if(e.signInMethod==="email-password"){const{error:n}=await Ar(r,e.email,e.password,e.options);return{error:n}}throw Error("Unknown deanonymization method")}async addSecurityKey(e){const{error:r,key:n}=await Kn(this._client,e);return{error:r,key:n}}async elevateEmailSecurityKey(e){if(!e)throw Error("A user email is required");return{...await Zn(this._client,e),mfa:null}}async createPAT(e,r){return Eo(this._client,{expiresAt:e,metadata:r})}onTokenChanged(e){return this._client.subscribe(()=>{var r;const n=(r=this._client.interpreter)==null?void 0:r.onTransition(({event:i,context:s})=>{i.type==="TOKEN_CHANGED"&&e(Lt(s))});return()=>n==null?void 0:n.stop()})}onAuthStateChanged(e){return this._client.subscribe(()=>{var r;const n=(r=this._client.interpreter)==null?void 0:r.onTransition(({event:i,context:s})=>{(i.type==="SIGNED_IN"||i.type==="SIGNED_OUT")&&e(i.type,Lt(s))});return()=>n==null?void 0:n.stop()})}isAuthenticated(){var e;return!!((e=this._client.interpreter)!=null&&e.getSnapshot().matches({authentication:"signedIn"}))}async isAuthenticatedAsync(){return(await this.waitUntilReady()).getSnapshot().matches({authentication:"signedIn"})}getAuthenticationStatus(){var e;const r=((e=this.client.interpreter)==null?void 0:e.getSnapshot().context.importTokenAttempts)||0;return this.isReady()?{isAuthenticated:this.isAuthenticated(),isLoading:!1,connectionAttempts:r}:{isAuthenticated:!1,isLoading:!0,connectionAttempts:r}}getAccessToken(){var e,r;return(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot().context.accessToken.value)!=null?r:void 0}getDecodedAccessToken(){const e=this.getAccessToken();return e?zt(e):null}getHasuraClaims(){var e;return((e=this.getDecodedAccessToken())==null?void 0:e["https://hasura.io/jwt/claims"])||null}getHasuraClaim(e){var r;return((r=this.getHasuraClaims())==null?void 0:r[e.startsWith("x-hasura-")?e:`x-hasura-${e}`])||null}async refreshSession(e){try{const r=await this.waitUntilReady();return new Promise(n=>{const i=e||r.getSnapshot().context.refreshToken.value;if(!i)return n({session:null,error:zs});const{changed:s}=r.send("TRY_TOKEN",{token:i});if(!s)return n({session:null,error:Js});r.onTransition(o=>{o.matches({token:{idle:"error"}})?n({session:null,error:Xs}):o.event.type==="TOKEN_CHANGED"&&n({session:Lt(o.context),error:null})})})}catch(r){return{session:null,error:r.message}}}getSession(){var e,r;return Lt((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)}getUser(){var e,r,n;return((n=(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)==null?void 0:n.user)||null}waitUntilReady(){const e=this._client.interpreter;if(!e)throw Error("Auth interpreter not set");return e.getSnapshot().hasTag("loading")?new Promise((r,n)=>{let i=setTimeout(()=>n("The state machine is not yet ready after 15 seconds."),15e3);e.onTransition(s=>{if(!s.hasTag("loading"))return clearTimeout(i),r(e)})}):Promise.resolve(e)}isReady(){var e,r;return!((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())!=null&&r.hasTag("loading"))}get client(){return this._client}}var So=typeof self=="object"?self.FormData:window.FormData;const Or=fr(So);let ii=globalThis.fetch;const br=async(t,e,{accessToken:r,name:n,fileId:i,bucketId:s,adminSecret:o,onUploadProgress:d,headers:u={}}={})=>{var l;const a={...u};s&&e.append("bucket-id",s),o&&(a["x-hasura-admin-secret"]=o),r&&(a.Authorization=`Bearer ${r}`);const c=`${t}/files`;if(typeof XMLHttpRequest=="undefined")try{e instanceof Or&&(ii=vr().fetch);const h=await ii(c,{method:"POST",headers:a,body:e}),f=await h.json();return h.ok?{fileMetadata:f,error:null}:{error:{status:h.status,message:((l=f==null?void 0:f.error)==null?void 0:l.message)||h.statusText,error:h.statusText},fileMetadata:null}}catch(h){return{error:{status:0,message:h.message,error:h.message},fileMetadata:null}}return new Promise(h=>{let f=new XMLHttpRequest;f.responseType="json",f.onload=()=>{var p,m,O,E,A;return f.status<200||f.status>=300?h({fileMetadata:null,error:{error:(m=(p=f.response)==null?void 0:p.error)!=null?m:f.response,message:(A=(E=(O=f.response)==null?void 0:O.error)==null?void 0:E.message)!=null?A:f.response,status:f.status}}):h({fileMetadata:f.response,error:null})},f.onerror=()=>h({fileMetadata:null,error:{error:f.statusText,message:f.statusText,status:f.status}}),d&&f.upload.addEventListener("progress",d,!1),f.open("POST",c,!0),Object.entries(a).forEach(([p,m])=>{f.setRequestHeader(p,m)}),f.send(e)})};function kr(t,e){if(!e||Object.keys(e).length===0)return t;const r=new URL(t),n=Object.entries(e).reduce((i,[s,o])=>({...i,[s.charAt(0)]:o}),{});return Object.entries(n).forEach(([i,s])=>{s&&r.searchParams.set(i,s)}),r.toString()}let ct;typeof ct=="undefined"&&(ct=vr().fetch);class wo{constructor({url:e}){this.headers={},this.url=e}async uploadFormData({formData:e,bucketId:r,headers:n}){const{error:i,fileMetadata:s}=await br(this.url,e,{bucketId:r,headers:{...this.headers,...n},accessToken:this.accessToken,adminSecret:this.adminSecret});return i?{fileMetadata:null,error:i}:s&&!("processedFiles"in s)?{fileMetadata:{processedFiles:[s]},error:null}:{fileMetadata:s,error:null}}async uploadFile({file:e,bucketId:r,id:n,name:i,headers:s}){const o=typeof window=="undefined"?new Or:new FormData;o.append("file[]",e),o.append("metadata[]",JSON.stringify({id:n,name:i}));const{error:d,fileMetadata:u}=await br(this.url,o,{accessToken:this.accessToken,adminSecret:this.adminSecret,bucketId:r,fileId:n,name:i,headers:{...this.headers,...s}});return d?{fileMetadata:null,error:d}:u&&"processedFiles"in u?{fileMetadata:u.processedFiles[0],error:null}:{fileMetadata:u,error:null}}async downloadFile(e){try{const{fileId:r,headers:n,...i}=e,s=kr(`${this.url}/files/${r}`,i),o=await ct(s,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...n}});if(!o.ok)throw new Error(await o.text());return{file:await o.blob(),error:null}}catch(r){return{file:null,error:r}}}async getPresignedUrl(e){try{const{fileId:r,headers:n}=e,i=await ct(`${this.url}/files/${r}/presignedurl`,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...n}});if(!i.ok)throw new Error(await i.text());return{presignedUrl:await i.json(),error:null}}catch(r){return{presignedUrl:null,error:r}}}async delete(e){try{const{fileId:r,headers:n}=e,i=await ct(`${this.url}/files/${r}`,{method:"DELETE",headers:{...this.generateAuthHeaders(),...this.headers,...n}});if(!i.ok)throw new Error(await i.text());return{error:null}}catch(r){return{error:r}}}setAccessToken(e){return this.accessToken=e,this}setAdminSecret(e){return this.adminSecret=e,this}getHeaders(){return this.headers}setHeaders(e){return e?(this.headers={...this.headers,...e},this):this}unsetHeaders(){const e=this.headers["x-hasura-role"];return this.headers=e?{"x-hasura-role":e}:{},this}generateAuthHeaders(){if(!(!this.adminSecret&&!this.accessToken))return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:{Authorization:`Bearer ${this.accessToken}`}}}class xo{constructor({url:e,adminSecret:r}){this.url=e,this.api=new wo({url:e}),this.setAdminSecret(r)}async upload(e){return"file"in e?this.api.uploadFile(e):this.api.uploadFormData(e)}getPublicUrl(e){const{fileId:r,...n}=e;return kr(`${this.url}/files/${r}`,n)}async getPresignedUrl(e){const{fileId:r,headers:n,...i}=e,{presignedUrl:s,error:o}=await this.api.getPresignedUrl(e);if(o)return{presignedUrl:null,error:o};if(!s)return{presignedUrl:null,error:new Error("Invalid file id")};const d=kr(s.url,i);return{presignedUrl:{...s,url:d},error:null}}async download(e){const{file:r,error:n}=await this.api.downloadFile(e);return n?{file:null,error:n}:r?{file:r,error:null}:{file:null,error:new Error("File does not exist")}}async delete(e){const{error:r}=await this.api.delete(e);return r?{error:r}:{error:null}}setAccessToken(e){return this.api.setAccessToken(e),this}setAdminSecret(e){return this.api.setAdminSecret(e),this}getHeaders(){return this.getHeaders()}setHeaders(e){return this.api.setHeaders(e),this}unsetHeaders(){return this.api.unsetHeaders(),this}}let Ir;typeof Ir=="undefined"&&(Ir=Or);const _r={progress:null,loaded:0,error:null,bucketId:void 0,file:void 0,id:void 0},si=()=>Oe({predictableActionArguments:!0,schema:{context:{},events:{}},tsTypes:{},context:{..._r},initial:"idle",on:{DESTROY:{actions:"sendDestroy",target:"stopped"}},states:{idle:{on:{ADD:{actions:"addFile"},UPLOAD:{cond:"hasFile",target:"uploading"}}},uploading:{entry:"resetProgress",on:{UPLOAD_PROGRESS:{actions:["incrementProgress","sendProgress"]},UPLOAD_DONE:"uploaded",UPLOAD_ERROR:"error",CANCEL:"idle"},invoke:{src:"uploadFile"}},uploaded:{entry:["setFileMetadata","sendDone"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},error:{entry:["setError","sendError"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},stopped:{type:"final"}}},{guards:{hasFile:(t,e)=>!!t.file||!!e.file},actions:{incrementProgress:M({loaded:(t,{loaded:e})=>e,progress:(t,{progress:e})=>e}),setFileMetadata:M({id:(t,{id:e})=>e,bucketId:(t,{bucketId:e})=>e,progress:t=>100}),setError:M({error:(t,{error:e})=>e}),sendProgress:()=>{},sendError:()=>{},sendDestroy:()=>{},sendDone:()=>{},resetProgress:M({progress:t=>null,loaded:t=>0}),resetContext:M(t=>_r),addFile:M({file:(t,{file:e})=>e,bucketId:(t,{bucketId:e})=>e,id:(t,{id:e})=>e})},services:{uploadFile:(t,e)=>r=>{const n=e.file||t.file,i=new Ir;i.append("file[]",n);let s=0;return br(e.url,i,{fileId:e.id||t.id,bucketId:e.bucketId||t.bucketId,accessToken:e.accessToken,adminSecret:e.adminSecret,name:e.name||n.name,onUploadProgress:o=>{const d=o.total?Math.round(o.loaded*n.size/o.total):0,u=d-s;s=d,r({type:"UPLOAD_PROGRESS",progress:o.total?Math.round(d*100/o.total):0,loaded:d,additions:u})}}).then(({fileMetadata:o,error:d})=>{if(d&&r({type:"UPLOAD_ERROR",error:d}),o&&!("processedFiles"in o)){const{id:u,bucketId:l}=o;r({type:"UPLOAD_DONE",id:u,bucketId:l})}if(o&&"processedFiles"in o){const{id:u,bucketId:l}=o.processedFiles[0];r({type:"UPLOAD_DONE",id:u,bucketId:l})}}),()=>{}}}}),{pure:Nr,sendParent:jt}=ms,Ao=()=>Oe({id:"files-list",schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,context:{progress:null,files:[],loaded:0,total:0},initial:"idle",on:{UPLOAD:{cond:"hasFileToDownload",actions:"addItem",target:"uploading"},ADD:{actions:"addItem"},REMOVE:{actions:"removeItem"}},states:{idle:{entry:["resetProgress","resetLoaded","resetTotal"],on:{CLEAR:{actions:"clearList",target:"idle"}}},uploading:{entry:["upload","startProgress","resetLoaded","resetTotal"],on:{UPLOAD_PROGRESS:{actions:["incrementProgress"]},UPLOAD_DONE:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],UPLOAD_ERROR:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],CANCEL:{actions:"cancel",target:"idle"}}},uploaded:{entry:"setUploaded",on:{CLEAR:{actions:"clearList",target:"idle"}}},error:{on:{CLEAR:{actions:"clearList",target:"idle"}}}}},{guards:{hasFileToDownload:(t,e)=>t.files.some(r=>r.getSnapshot().matches("idle"))||!!e.files,isAllUploaded:t=>t.files.every(e=>{var r;return(r=e.getSnapshot())==null?void 0:r.matches("uploaded")}),isAllUploadedOrError:t=>t.files.every(e=>{const r=e.getSnapshot();return(r==null?void 0:r.matches("error"))||(r==null?void 0:r.matches("uploaded"))})},actions:{incrementProgress:M((t,e)=>{const r=t.loaded+e.additions,n=Math.round(r*100/t.total);return{...t,loaded:r,progress:n}}),setUploaded:M({progress:t=>100,loaded:({files:t})=>t.map(e=>e.getSnapshot()).filter(e=>e.matches("uploaded")).reduce((e,r)=>{var n;return e+((n=r.context.file)==null?void 0:n.size)},0)}),resetTotal:M({total:({files:t})=>t.map(e=>e.getSnapshot()).filter(e=>!e.matches("uploaded")).reduce((e,r)=>{var n;return e+((n=r.context.file)==null?void 0:n.size)},0)}),resetLoaded:M({loaded:t=>0}),startProgress:M({progress:t=>0}),resetProgress:M({progress:t=>null}),addItem:M((t,{files:e,bucketId:r})=>{const n=e?Array.isArray(e)?e:"item"in e?Array.from(e):[e]:[],i=t.total+n.reduce((o,d)=>o+d.size,0),s=Math.round(t.loaded*100/i);return{files:[...t.files,...n.map(o=>Ps(si().withConfig({actions:{sendProgress:jt((d,{additions:u})=>({type:"UPLOAD_PROGRESS",additions:u})),sendDone:jt("UPLOAD_DONE"),sendError:jt("UPLOAD_ERROR"),sendDestroy:jt("REMOVE")}}).withContext({..._r,file:o,bucketId:r}),{sync:!0}))],total:i,loaded:t.loaded,progress:s}}),removeItem:M({files:t=>t.files.filter(e=>{var r,n;const i=(r=e.getSnapshot())==null?void 0:r.matches("stopped");return i&&((n=e.stop)==null||n.call(e)),!i})}),clearList:Nr(t=>t.files.map(e=>se({type:"DESTROY"},{to:e.id}))),upload:Nr((t,e)=>t.files.map(r=>se(e,{to:r.id}))),cancel:Nr(t=>t.files.map(e=>se({type:"CANCEL"},{to:e.id})))}}),Oo=async(t,e)=>new Promise(r=>{e.send({type:"UPLOAD",...t}),e.subscribe(n=>{var i;n.matches("error")?r({error:n.context.error,isError:!0,isUploaded:!1}):n.matches("uploaded")&&r({error:null,isError:!1,isUploaded:!0,id:n.context.id,bucketId:n.context.id,name:(i=n.context.file)==null?void 0:i.name})})}),bo=async(t,e)=>new Promise(r=>{e.send({type:"UPLOAD",...t,files:t.files}),e.onTransition(n=>{n.matches("error")?r({errors:n.context.files.filter(i=>{var s;return(s=i.getSnapshot())==null?void 0:s.context.error}),isError:!0,files:[]}):n.matches("uploaded")&&r({errors:[],isError:!1,files:n.context.files})})});function ko(t,e){return e=e||{},new Promise(function(r,n){var i=new XMLHttpRequest,s=[],o=[],d={},u=function(){return{ok:(i.status/100|0)==2,statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:u,headers:{keys:function(){return s},entries:function(){return o},get:function(a){return d[a.toLowerCase()]},has:function(a){return a.toLowerCase()in d}}}};for(var l in i.open(e.method||"get",t,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(a,c,h){s.push(c=c.toLowerCase()),o.push([c,h]),d[c]=d[c]?d[c]+","+h:h}),r(u())},i.onerror=n,i.withCredentials=e.credentials=="include",e.headers)i.setRequestHeader(l,e.headers[l]);i.send(e.body||null)})}const oi=Vs(Object.freeze(Object.defineProperty({__proto__:null,default:ko},Symbol.toStringTag,{value:"Module"})));var Io=self.fetch||(self.fetch=oi.default||oi);const ai=fr(Io);function Ft(t,e){if(!!!t)throw new Error(e)}function _o(t){return typeof t=="object"&&t!==null}function No(t,e){if(!!!t)throw new Error("Unexpected invariant triggered.")}const Ro=/\r\n|[\n\r]/g;function Rr(t,e){let r=0,n=1;for(const i of t.body.matchAll(Ro)){if(typeof i.index=="number"||No(!1),i.index>=e)break;r=i.index+i[0].length,n+=1}return{line:n,column:e+1-r}}function Do(t){return ci(t.source,Rr(t.source,t.start))}function ci(t,e){const r=t.locationOffset.column-1,n="".padStart(r)+t.body,i=e.line-1,s=t.locationOffset.line-1,o=e.line+s,d=e.line===1?r:0,u=e.column+d,l=`${t.name}:${o}:${u}
`,a=n.split(/\r\n|[\n\r]/g),c=a[i];if(c.length>120){const h=Math.floor(u/80),f=u%80,p=[];for(let m=0;m<c.length;m+=80)p.push(c.slice(m,m+80));return l+ui([[`${o} |`,p[0]],...p.slice(1,h+1).map(m=>["|",m]),["|","^".padStart(f)],["|",p[h+1]]])}return l+ui([[`${o-1} |`,a[i-1]],[`${o} |`,c],["|","^".padStart(u)],[`${o+1} |`,a[i+1]]])}function ui(t){const e=t.filter(([n,i])=>i!==void 0),r=Math.max(...e.map(([n])=>n.length));return e.map(([n,i])=>n.padStart(r)+(i?" "+i:"")).join(`
`)}function Co(t){const e=t[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:t[1],positions:t[2],path:t[3],originalError:t[4],extensions:t[5]}:e}class Dr extends Error{constructor(e,...r){var n,i,s;const{nodes:o,source:d,positions:u,path:l,originalError:a,extensions:c}=Co(r);super(e),this.name="GraphQLError",this.path=l!=null?l:void 0,this.originalError=a!=null?a:void 0,this.nodes=li(Array.isArray(o)?o:o?[o]:void 0);const h=li((n=this.nodes)===null||n===void 0?void 0:n.map(p=>p.loc).filter(p=>p!=null));this.source=d!=null?d:h==null||(i=h[0])===null||i===void 0?void 0:i.source,this.positions=u!=null?u:h==null?void 0:h.map(p=>p.start),this.locations=u&&d?u.map(p=>Rr(d,p)):h==null?void 0:h.map(p=>Rr(p.source,p.start));const f=_o(a==null?void 0:a.extensions)?a==null?void 0:a.extensions:void 0;this.extensions=(s=c!=null?c:f)!==null&&s!==void 0?s:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),a!=null&&a.stack?Object.defineProperty(this,"stack",{value:a.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Dr):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const r of this.nodes)r.loc&&(e+=`

`+Do(r.loc));else if(this.source&&this.locations)for(const r of this.locations)e+=`

`+ci(this.source,r);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function li(t){return t===void 0||t.length===0?void 0:t}function oe(t,e,r){return new Dr(`Syntax Error: ${r}`,{source:t,positions:[e]})}class Po{constructor(e,r,n){this.start=e.start,this.end=r.end,this.startToken=e,this.endToken=r,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class di{constructor(e,r,n,i,s,o){this.kind=e,this.start=r,this.end=n,this.line=i,this.column=s,this.value=o,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const hi={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},Lo=new Set(Object.keys(hi));function fi(t){const e=t==null?void 0:t.kind;return typeof e=="string"&&Lo.has(e)}var Ke;(function(t){t.QUERY="query",t.MUTATION="mutation",t.SUBSCRIPTION="subscription"})(Ke||(Ke={}));var Cr;(function(t){t.QUERY="QUERY",t.MUTATION="MUTATION",t.SUBSCRIPTION="SUBSCRIPTION",t.FIELD="FIELD",t.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",t.FRAGMENT_SPREAD="FRAGMENT_SPREAD",t.INLINE_FRAGMENT="INLINE_FRAGMENT",t.VARIABLE_DEFINITION="VARIABLE_DEFINITION",t.SCHEMA="SCHEMA",t.SCALAR="SCALAR",t.OBJECT="OBJECT",t.FIELD_DEFINITION="FIELD_DEFINITION",t.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",t.INTERFACE="INTERFACE",t.UNION="UNION",t.ENUM="ENUM",t.ENUM_VALUE="ENUM_VALUE",t.INPUT_OBJECT="INPUT_OBJECT",t.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(Cr||(Cr={}));var C;(function(t){t.NAME="Name",t.DOCUMENT="Document",t.OPERATION_DEFINITION="OperationDefinition",t.VARIABLE_DEFINITION="VariableDefinition",t.SELECTION_SET="SelectionSet",t.FIELD="Field",t.ARGUMENT="Argument",t.FRAGMENT_SPREAD="FragmentSpread",t.INLINE_FRAGMENT="InlineFragment",t.FRAGMENT_DEFINITION="FragmentDefinition",t.VARIABLE="Variable",t.INT="IntValue",t.FLOAT="FloatValue",t.STRING="StringValue",t.BOOLEAN="BooleanValue",t.NULL="NullValue",t.ENUM="EnumValue",t.LIST="ListValue",t.OBJECT="ObjectValue",t.OBJECT_FIELD="ObjectField",t.DIRECTIVE="Directive",t.NAMED_TYPE="NamedType",t.LIST_TYPE="ListType",t.NON_NULL_TYPE="NonNullType",t.SCHEMA_DEFINITION="SchemaDefinition",t.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",t.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",t.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",t.FIELD_DEFINITION="FieldDefinition",t.INPUT_VALUE_DEFINITION="InputValueDefinition",t.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",t.UNION_TYPE_DEFINITION="UnionTypeDefinition",t.ENUM_TYPE_DEFINITION="EnumTypeDefinition",t.ENUM_VALUE_DEFINITION="EnumValueDefinition",t.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",t.DIRECTIVE_DEFINITION="DirectiveDefinition",t.SCHEMA_EXTENSION="SchemaExtension",t.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",t.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",t.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",t.UNION_TYPE_EXTENSION="UnionTypeExtension",t.ENUM_TYPE_EXTENSION="EnumTypeExtension",t.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(C||(C={}));function Pr(t){return t===9||t===32}function ut(t){return t>=48&&t<=57}function pi(t){return t>=97&&t<=122||t>=65&&t<=90}function vi(t){return pi(t)||t===95}function Uo(t){return pi(t)||ut(t)||t===95}function Mo(t){var e;let r=Number.MAX_SAFE_INTEGER,n=null,i=-1;for(let o=0;o<t.length;++o){var s;const d=t[o],u=jo(d);u!==d.length&&(n=(s=n)!==null&&s!==void 0?s:o,i=o,o!==0&&u<r&&(r=u))}return t.map((o,d)=>d===0?o:o.slice(r)).slice((e=n)!==null&&e!==void 0?e:0,i+1)}function jo(t){let e=0;for(;e<t.length&&Pr(t.charCodeAt(e));)++e;return e}function Fo(t,e){const r=t.replace(/"""/g,'\\"""'),n=r.split(/\r\n|[\n\r]/g),i=n.length===1,s=n.length>1&&n.slice(1).every(f=>f.length===0||Pr(f.charCodeAt(0))),o=r.endsWith('\\"""'),d=t.endsWith('"')&&!o,u=t.endsWith("\\"),l=d||u,a=!i||t.length>70||l||s||o;let c="";const h=i&&Pr(t.charCodeAt(0));return(a&&!h||s)&&(c+=`
`),c+=r,(a||l)&&(c+=`
`),'"""'+c+'"""'}var y;(function(t){t.SOF="<SOF>",t.EOF="<EOF>",t.BANG="!",t.DOLLAR="$",t.AMP="&",t.PAREN_L="(",t.PAREN_R=")",t.SPREAD="...",t.COLON=":",t.EQUALS="=",t.AT="@",t.BRACKET_L="[",t.BRACKET_R="]",t.BRACE_L="{",t.PIPE="|",t.BRACE_R="}",t.NAME="Name",t.INT="Int",t.FLOAT="Float",t.STRING="String",t.BLOCK_STRING="BlockString",t.COMMENT="Comment"})(y||(y={}));class Vo{constructor(e){const r=new di(y.SOF,0,0,0,0);this.source=e,this.lastToken=r,this.token=r,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==y.EOF)do if(e.next)e=e.next;else{const r=Go(this,e.end);e.next=r,r.prev=e,e=r}while(e.kind===y.COMMENT);return e}}function Bo(t){return t===y.BANG||t===y.DOLLAR||t===y.AMP||t===y.PAREN_L||t===y.PAREN_R||t===y.SPREAD||t===y.COLON||t===y.EQUALS||t===y.AT||t===y.BRACKET_L||t===y.BRACKET_R||t===y.BRACE_L||t===y.PIPE||t===y.BRACE_R}function qe(t){return t>=0&&t<=55295||t>=57344&&t<=1114111}function Vt(t,e){return mi(t.charCodeAt(e))&&yi(t.charCodeAt(e+1))}function mi(t){return t>=55296&&t<=56319}function yi(t){return t>=56320&&t<=57343}function Ce(t,e){const r=t.source.body.codePointAt(e);if(r===void 0)return y.EOF;if(r>=32&&r<=126){const n=String.fromCodePoint(r);return n==='"'?`'"'`:`"${n}"`}return"U+"+r.toString(16).toUpperCase().padStart(4,"0")}function re(t,e,r,n,i){const s=t.line,o=1+r-t.lineStart;return new di(e,r,n,s,o,i)}function Go(t,e){const r=t.source.body,n=r.length;let i=e;for(;i<n;){const s=r.charCodeAt(i);switch(s){case 65279:case 9:case 32:case 44:++i;continue;case 10:++i,++t.line,t.lineStart=i;continue;case 13:r.charCodeAt(i+1)===10?i+=2:++i,++t.line,t.lineStart=i;continue;case 35:return Ho(t,i);case 33:return re(t,y.BANG,i,i+1);case 36:return re(t,y.DOLLAR,i,i+1);case 38:return re(t,y.AMP,i,i+1);case 40:return re(t,y.PAREN_L,i,i+1);case 41:return re(t,y.PAREN_R,i,i+1);case 46:if(r.charCodeAt(i+1)===46&&r.charCodeAt(i+2)===46)return re(t,y.SPREAD,i,i+3);break;case 58:return re(t,y.COLON,i,i+1);case 61:return re(t,y.EQUALS,i,i+1);case 64:return re(t,y.AT,i,i+1);case 91:return re(t,y.BRACKET_L,i,i+1);case 93:return re(t,y.BRACKET_R,i,i+1);case 123:return re(t,y.BRACE_L,i,i+1);case 124:return re(t,y.PIPE,i,i+1);case 125:return re(t,y.BRACE_R,i,i+1);case 34:return r.charCodeAt(i+1)===34&&r.charCodeAt(i+2)===34?Jo(t,i):Ko(t,i)}if(ut(s)||s===45)return Yo(t,i,s);if(vi(s))return Wo(t,i);throw oe(t.source,i,s===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:qe(s)||Vt(r,i)?`Unexpected character: ${Ce(t,i)}.`:`Invalid character: ${Ce(t,i)}.`)}return re(t,y.EOF,n,n)}function Ho(t,e){const r=t.source.body,n=r.length;let i=e+1;for(;i<n;){const s=r.charCodeAt(i);if(s===10||s===13)break;if(qe(s))++i;else if(Vt(r,i))i+=2;else break}return re(t,y.COMMENT,e,i,r.slice(e+1,i))}function Yo(t,e,r){const n=t.source.body;let i=e,s=r,o=!1;if(s===45&&(s=n.charCodeAt(++i)),s===48){if(s=n.charCodeAt(++i),ut(s))throw oe(t.source,i,`Invalid number, unexpected digit after 0: ${Ce(t,i)}.`)}else i=Lr(t,i,s),s=n.charCodeAt(i);if(s===46&&(o=!0,s=n.charCodeAt(++i),i=Lr(t,i,s),s=n.charCodeAt(i)),(s===69||s===101)&&(o=!0,s=n.charCodeAt(++i),(s===43||s===45)&&(s=n.charCodeAt(++i)),i=Lr(t,i,s),s=n.charCodeAt(i)),s===46||vi(s))throw oe(t.source,i,`Invalid number, expected digit but got: ${Ce(t,i)}.`);return re(t,o?y.FLOAT:y.INT,e,i,n.slice(e,i))}function Lr(t,e,r){if(!ut(r))throw oe(t.source,e,`Invalid number, expected digit but got: ${Ce(t,e)}.`);const n=t.source.body;let i=e+1;for(;ut(n.charCodeAt(i));)++i;return i}function Ko(t,e){const r=t.source.body,n=r.length;let i=e+1,s=i,o="";for(;i<n;){const d=r.charCodeAt(i);if(d===34)return o+=r.slice(s,i),re(t,y.STRING,e,i+1,o);if(d===92){o+=r.slice(s,i);const u=r.charCodeAt(i+1)===117?r.charCodeAt(i+2)===123?qo(t,i):$o(t,i):zo(t,i);o+=u.value,i+=u.size,s=i;continue}if(d===10||d===13)break;if(qe(d))++i;else if(Vt(r,i))i+=2;else throw oe(t.source,i,`Invalid character within String: ${Ce(t,i)}.`)}throw oe(t.source,i,"Unterminated string.")}function qo(t,e){const r=t.source.body;let n=0,i=3;for(;i<12;){const s=r.charCodeAt(e+i++);if(s===125){if(i<5||!qe(n))break;return{value:String.fromCodePoint(n),size:i}}if(n=n<<4|lt(s),n<0)break}throw oe(t.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+i)}".`)}function $o(t,e){const r=t.source.body,n=gi(r,e+2);if(qe(n))return{value:String.fromCodePoint(n),size:6};if(mi(n)&&r.charCodeAt(e+6)===92&&r.charCodeAt(e+7)===117){const i=gi(r,e+8);if(yi(i))return{value:String.fromCodePoint(n,i),size:12}}throw oe(t.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+6)}".`)}function gi(t,e){return lt(t.charCodeAt(e))<<12|lt(t.charCodeAt(e+1))<<8|lt(t.charCodeAt(e+2))<<4|lt(t.charCodeAt(e+3))}function lt(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:-1}function zo(t,e){const r=t.source.body;switch(r.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw oe(t.source,e,`Invalid character escape sequence: "${r.slice(e,e+2)}".`)}function Jo(t,e){const r=t.source.body,n=r.length;let i=t.lineStart,s=e+3,o=s,d="";const u=[];for(;s<n;){const l=r.charCodeAt(s);if(l===34&&r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34){d+=r.slice(o,s),u.push(d);const a=re(t,y.BLOCK_STRING,e,s+3,Mo(u).join(`
`));return t.line+=u.length-1,t.lineStart=i,a}if(l===92&&r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34&&r.charCodeAt(s+3)===34){d+=r.slice(o,s),o=s+1,s+=4;continue}if(l===10||l===13){d+=r.slice(o,s),u.push(d),l===13&&r.charCodeAt(s+1)===10?s+=2:++s,d="",o=s,i=s;continue}if(qe(l))++s;else if(Vt(r,s))s+=2;else throw oe(t.source,s,`Invalid character within String: ${Ce(t,s)}.`)}throw oe(t.source,s,"Unterminated string.")}function Wo(t,e){const r=t.source.body,n=r.length;let i=e+1;for(;i<n;){const s=r.charCodeAt(i);if(Uo(s))++i;else break}return re(t,y.NAME,e,i,r.slice(e,i))}const Qo=10,Ei=2;function Ur(t){return Bt(t,[])}function Bt(t,e){switch(typeof t){case"string":return JSON.stringify(t);case"function":return t.name?`[function ${t.name}]`:"[function]";case"object":return Xo(t,e);default:return String(t)}}function Xo(t,e){if(t===null)return"null";if(e.includes(t))return"[Circular]";const r=[...e,t];if(Zo(t)){const n=t.toJSON();if(n!==t)return typeof n=="string"?n:Bt(n,r)}else if(Array.isArray(t))return ta(t,r);return ea(t,r)}function Zo(t){return typeof t.toJSON=="function"}function ea(t,e){const r=Object.entries(t);return r.length===0?"{}":e.length>Ei?"["+ra(t)+"]":"{ "+r.map(([i,s])=>i+": "+Bt(s,e)).join(", ")+" }"}function ta(t,e){if(t.length===0)return"[]";if(e.length>Ei)return"[Array]";const r=Math.min(Qo,t.length),n=t.length-r,i=[];for(let s=0;s<r;++s)i.push(Bt(t[s],e));return n===1?i.push("... 1 more item"):n>1&&i.push(`... ${n} more items`),"["+i.join(", ")+"]"}function ra(t){const e=Object.prototype.toString.call(t).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof t.constructor=="function"){const r=t.constructor.name;if(typeof r=="string"&&r!=="")return r}return e}const na=globalThis.process&&globalThis.process.env.NODE_ENV==="production"?function(e,r){return e instanceof r}:function(e,r){if(e instanceof r)return!0;if(typeof e=="object"&&e!==null){var n;const i=r.prototype[Symbol.toStringTag],s=Symbol.toStringTag in e?e[Symbol.toStringTag]:(n=e.constructor)===null||n===void 0?void 0:n.name;if(i===s){const o=Ur(e);throw new Error(`Cannot use ${i} "${o}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class Ti{constructor(e,r="GraphQL request",n={line:1,column:1}){typeof e=="string"||Ft(!1,`Body must be a string. Received: ${Ur(e)}.`),this.body=e,this.name=r,this.locationOffset=n,this.locationOffset.line>0||Ft(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||Ft(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function ia(t){return na(t,Ti)}function sa(t,e){return new oa(t,e).parseDocument()}class oa{constructor(e,r={}){const n=ia(e)?e:new Ti(e);this._lexer=new Vo(n),this._options=r,this._tokenCounter=0}parseName(){const e=this.expectToken(y.NAME);return this.node(e,{kind:C.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:C.DOCUMENT,definitions:this.many(y.SOF,this.parseDefinition,y.EOF)})}parseDefinition(){if(this.peek(y.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),r=e?this._lexer.lookahead():this._lexer.token;if(r.kind===y.NAME){switch(r.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw oe(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(r.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(r)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(y.BRACE_L))return this.node(e,{kind:C.OPERATION_DEFINITION,operation:Ke.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const r=this.parseOperationType();let n;return this.peek(y.NAME)&&(n=this.parseName()),this.node(e,{kind:C.OPERATION_DEFINITION,operation:r,name:n,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(y.NAME);switch(e.value){case"query":return Ke.QUERY;case"mutation":return Ke.MUTATION;case"subscription":return Ke.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(y.PAREN_L,this.parseVariableDefinition,y.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:C.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(y.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(y.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(y.DOLLAR),this.node(e,{kind:C.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:C.SELECTION_SET,selections:this.many(y.BRACE_L,this.parseSelection,y.BRACE_R)})}parseSelection(){return this.peek(y.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,r=this.parseName();let n,i;return this.expectOptionalToken(y.COLON)?(n=r,i=this.parseName()):i=r,this.node(e,{kind:C.FIELD,alias:n,name:i,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(y.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const r=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(y.PAREN_L,r,y.PAREN_R)}parseArgument(e=!1){const r=this._lexer.token,n=this.parseName();return this.expectToken(y.COLON),this.node(r,{kind:C.ARGUMENT,name:n,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(y.SPREAD);const r=this.expectOptionalKeyword("on");return!r&&this.peek(y.NAME)?this.node(e,{kind:C.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:C.INLINE_FRAGMENT,typeCondition:r?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:C.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:C.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const r=this._lexer.token;switch(r.kind){case y.BRACKET_L:return this.parseList(e);case y.BRACE_L:return this.parseObject(e);case y.INT:return this.advanceLexer(),this.node(r,{kind:C.INT,value:r.value});case y.FLOAT:return this.advanceLexer(),this.node(r,{kind:C.FLOAT,value:r.value});case y.STRING:case y.BLOCK_STRING:return this.parseStringLiteral();case y.NAME:switch(this.advanceLexer(),r.value){case"true":return this.node(r,{kind:C.BOOLEAN,value:!0});case"false":return this.node(r,{kind:C.BOOLEAN,value:!1});case"null":return this.node(r,{kind:C.NULL});default:return this.node(r,{kind:C.ENUM,value:r.value})}case y.DOLLAR:if(e)if(this.expectToken(y.DOLLAR),this._lexer.token.kind===y.NAME){const n=this._lexer.token.value;throw oe(this._lexer.source,r.start,`Unexpected variable "$${n}" in constant value.`)}else throw this.unexpected(r);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:C.STRING,value:e.value,block:e.kind===y.BLOCK_STRING})}parseList(e){const r=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:C.LIST,values:this.any(y.BRACKET_L,r,y.BRACKET_R)})}parseObject(e){const r=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:C.OBJECT,fields:this.any(y.BRACE_L,r,y.BRACE_R)})}parseObjectField(e){const r=this._lexer.token,n=this.parseName();return this.expectToken(y.COLON),this.node(r,{kind:C.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e)})}parseDirectives(e){const r=[];for(;this.peek(y.AT);)r.push(this.parseDirective(e));return r}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const r=this._lexer.token;return this.expectToken(y.AT),this.node(r,{kind:C.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let r;if(this.expectOptionalToken(y.BRACKET_L)){const n=this.parseTypeReference();this.expectToken(y.BRACKET_R),r=this.node(e,{kind:C.LIST_TYPE,type:n})}else r=this.parseNamedType();return this.expectOptionalToken(y.BANG)?this.node(e,{kind:C.NON_NULL_TYPE,type:r}):r}parseNamedType(){return this.node(this._lexer.token,{kind:C.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(y.STRING)||this.peek(y.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("schema");const n=this.parseConstDirectives(),i=this.many(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);return this.node(e,{kind:C.SCHEMA_DEFINITION,description:r,directives:n,operationTypes:i})}parseOperationTypeDefinition(){const e=this._lexer.token,r=this.parseOperationType();this.expectToken(y.COLON);const n=this.parseNamedType();return this.node(e,{kind:C.OPERATION_TYPE_DEFINITION,operation:r,type:n})}parseScalarTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("scalar");const n=this.parseName(),i=this.parseConstDirectives();return this.node(e,{kind:C.SCALAR_TYPE_DEFINITION,description:r,name:n,directives:i})}parseObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("type");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:C.OBJECT_TYPE_DEFINITION,description:r,name:n,interfaces:i,directives:s,fields:o})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(y.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(y.BRACE_L,this.parseFieldDefinition,y.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseName(),i=this.parseArgumentDefs();this.expectToken(y.COLON);const s=this.parseTypeReference(),o=this.parseConstDirectives();return this.node(e,{kind:C.FIELD_DEFINITION,description:r,name:n,arguments:i,type:s,directives:o})}parseArgumentDefs(){return this.optionalMany(y.PAREN_L,this.parseInputValueDef,y.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseName();this.expectToken(y.COLON);const i=this.parseTypeReference();let s;this.expectOptionalToken(y.EQUALS)&&(s=this.parseConstValueLiteral());const o=this.parseConstDirectives();return this.node(e,{kind:C.INPUT_VALUE_DEFINITION,description:r,name:n,type:i,defaultValue:s,directives:o})}parseInterfaceTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("interface");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:C.INTERFACE_TYPE_DEFINITION,description:r,name:n,interfaces:i,directives:s,fields:o})}parseUnionTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("union");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseUnionMemberTypes();return this.node(e,{kind:C.UNION_TYPE_DEFINITION,description:r,name:n,directives:i,types:s})}parseUnionMemberTypes(){return this.expectOptionalToken(y.EQUALS)?this.delimitedMany(y.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("enum");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseEnumValuesDefinition();return this.node(e,{kind:C.ENUM_TYPE_DEFINITION,description:r,name:n,directives:i,values:s})}parseEnumValuesDefinition(){return this.optionalMany(y.BRACE_L,this.parseEnumValueDefinition,y.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseEnumValueName(),i=this.parseConstDirectives();return this.node(e,{kind:C.ENUM_VALUE_DEFINITION,description:r,name:n,directives:i})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw oe(this._lexer.source,this._lexer.token.start,`${Gt(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("input");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseInputFieldsDefinition();return this.node(e,{kind:C.INPUT_OBJECT_TYPE_DEFINITION,description:r,name:n,directives:i,fields:s})}parseInputFieldsDefinition(){return this.optionalMany(y.BRACE_L,this.parseInputValueDef,y.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===y.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const r=this.parseConstDirectives(),n=this.optionalMany(y.BRACE_L,this.parseOperationTypeDefinition,y.BRACE_R);if(r.length===0&&n.length===0)throw this.unexpected();return this.node(e,{kind:C.SCHEMA_EXTENSION,directives:r,operationTypes:n})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const r=this.parseName(),n=this.parseConstDirectives();if(n.length===0)throw this.unexpected();return this.node(e,{kind:C.SCALAR_TYPE_EXTENSION,name:r,directives:n})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:C.OBJECT_TYPE_EXTENSION,name:r,interfaces:n,directives:i,fields:s})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:C.INTERFACE_TYPE_EXTENSION,name:r,interfaces:n,directives:i,fields:s})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseUnionMemberTypes();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:C.UNION_TYPE_EXTENSION,name:r,directives:n,types:i})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseEnumValuesDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:C.ENUM_TYPE_EXTENSION,name:r,directives:n,values:i})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseInputFieldsDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:C.INPUT_OBJECT_TYPE_EXTENSION,name:r,directives:n,fields:i})}parseDirectiveDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("directive"),this.expectToken(y.AT);const n=this.parseName(),i=this.parseArgumentDefs(),s=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const o=this.parseDirectiveLocations();return this.node(e,{kind:C.DIRECTIVE_DEFINITION,description:r,name:n,arguments:i,repeatable:s,locations:o})}parseDirectiveLocations(){return this.delimitedMany(y.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,r=this.parseName();if(Object.prototype.hasOwnProperty.call(Cr,r.value))return r;throw this.unexpected(e)}node(e,r){return this._options.noLocation!==!0&&(r.loc=new Po(e,this._lexer.lastToken,this._lexer.source)),r}peek(e){return this._lexer.token.kind===e}expectToken(e){const r=this._lexer.token;if(r.kind===e)return this.advanceLexer(),r;throw oe(this._lexer.source,r.start,`Expected ${Si(e)}, found ${Gt(r)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const r=this._lexer.token;if(r.kind===y.NAME&&r.value===e)this.advanceLexer();else throw oe(this._lexer.source,r.start,`Expected "${e}", found ${Gt(r)}.`)}expectOptionalKeyword(e){const r=this._lexer.token;return r.kind===y.NAME&&r.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const r=e!=null?e:this._lexer.token;return oe(this._lexer.source,r.start,`Unexpected ${Gt(r)}.`)}any(e,r,n){this.expectToken(e);const i=[];for(;!this.expectOptionalToken(n);)i.push(r.call(this));return i}optionalMany(e,r,n){if(this.expectOptionalToken(e)){const i=[];do i.push(r.call(this));while(!this.expectOptionalToken(n));return i}return[]}many(e,r,n){this.expectToken(e);const i=[];do i.push(r.call(this));while(!this.expectOptionalToken(n));return i}delimitedMany(e,r){this.expectOptionalToken(e);const n=[];do n.push(r.call(this));while(this.expectOptionalToken(e));return n}advanceLexer(){const{maxTokens:e}=this._options,r=this._lexer.advance();if(e!==void 0&&r.kind!==y.EOF&&(++this._tokenCounter,this._tokenCounter>e))throw oe(this._lexer.source,r.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function Gt(t){const e=t.value;return Si(t.kind)+(e!=null?` "${e}"`:"")}function Si(t){return Bo(t)?`"${t}"`:t}function aa(t){return`"${t.replace(ca,ua)}"`}const ca=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function ua(t){return la[t.charCodeAt(0)]}const la=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],da=Object.freeze({});function ha(t,e,r=hi){const n=new Map;for(const E of Object.values(C))n.set(E,fa(e,E));let i,s=Array.isArray(t),o=[t],d=-1,u=[],l=t,a,c;const h=[],f=[];do{d++;const E=d===o.length,A=E&&u.length!==0;if(E){if(a=f.length===0?void 0:h[h.length-1],l=c,c=f.pop(),A)if(s){l=l.slice();let x=0;for(const[P,k]of u){const I=P-x;k===null?(l.splice(I,1),x++):l[I]=k}}else{l=Object.defineProperties({},Object.getOwnPropertyDescriptors(l));for(const[x,P]of u)l[x]=P}d=i.index,o=i.keys,u=i.edits,s=i.inArray,i=i.prev}else if(c){if(a=s?d:o[d],l=c[a],l==null)continue;h.push(a)}let w;if(!Array.isArray(l)){var p,m;fi(l)||Ft(!1,`Invalid AST Node: ${Ur(l)}.`);const x=E?(p=n.get(l.kind))===null||p===void 0?void 0:p.leave:(m=n.get(l.kind))===null||m===void 0?void 0:m.enter;if(w=x==null?void 0:x.call(e,l,a,c,h,f),w===da)break;if(w===!1){if(!E){h.pop();continue}}else if(w!==void 0&&(u.push([a,w]),!E))if(fi(w))l=w;else{h.pop();continue}}if(w===void 0&&A&&u.push([a,l]),E)h.pop();else{var O;i={inArray:s,index:d,keys:o,edits:u,prev:i},s=Array.isArray(l),o=s?l:(O=r[l.kind])!==null&&O!==void 0?O:[],d=-1,u=[],c&&f.push(c),c=l}}while(i!==void 0);return u.length!==0?u[u.length-1][1]:t}function fa(t,e){const r=t[e];return typeof r=="object"?r:typeof r=="function"?{enter:r,leave:void 0}:{enter:t.enter,leave:t.leave}}function pa(t){return ha(t,ma)}const va=80,ma={Name:{leave:t=>t.value},Variable:{leave:t=>"$"+t.name},Document:{leave:t=>b(t.definitions,`

`)},OperationDefinition:{leave(t){const e=j("(",b(t.variableDefinitions,", "),")"),r=b([t.operation,b([t.name,e]),b(t.directives," ")]," ");return(r==="query"?"":r+" ")+t.selectionSet}},VariableDefinition:{leave:({variable:t,type:e,defaultValue:r,directives:n})=>t+": "+e+j(" = ",r)+j(" ",b(n," "))},SelectionSet:{leave:({selections:t})=>pe(t)},Field:{leave({alias:t,name:e,arguments:r,directives:n,selectionSet:i}){const s=j("",t,": ")+e;let o=s+j("(",b(r,", "),")");return o.length>va&&(o=s+j(`(
`,Ht(b(r,`
`)),`
)`)),b([o,b(n," "),i]," ")}},Argument:{leave:({name:t,value:e})=>t+": "+e},FragmentSpread:{leave:({name:t,directives:e})=>"..."+t+j(" ",b(e," "))},InlineFragment:{leave:({typeCondition:t,directives:e,selectionSet:r})=>b(["...",j("on ",t),b(e," "),r]," ")},FragmentDefinition:{leave:({name:t,typeCondition:e,variableDefinitions:r,directives:n,selectionSet:i})=>`fragment ${t}${j("(",b(r,", "),")")} on ${e} ${j("",b(n," ")," ")}`+i},IntValue:{leave:({value:t})=>t},FloatValue:{leave:({value:t})=>t},StringValue:{leave:({value:t,block:e})=>e?Fo(t):aa(t)},BooleanValue:{leave:({value:t})=>t?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:t})=>t},ListValue:{leave:({values:t})=>"["+b(t,", ")+"]"},ObjectValue:{leave:({fields:t})=>"{"+b(t,", ")+"}"},ObjectField:{leave:({name:t,value:e})=>t+": "+e},Directive:{leave:({name:t,arguments:e})=>"@"+t+j("(",b(e,", "),")")},NamedType:{leave:({name:t})=>t},ListType:{leave:({type:t})=>"["+t+"]"},NonNullType:{leave:({type:t})=>t+"!"},SchemaDefinition:{leave:({description:t,directives:e,operationTypes:r})=>j("",t,`
`)+b(["schema",b(e," "),pe(r)]," ")},OperationTypeDefinition:{leave:({operation:t,type:e})=>t+": "+e},ScalarTypeDefinition:{leave:({description:t,name:e,directives:r})=>j("",t,`
`)+b(["scalar",e,b(r," ")]," ")},ObjectTypeDefinition:{leave:({description:t,name:e,interfaces:r,directives:n,fields:i})=>j("",t,`
`)+b(["type",e,j("implements ",b(r," & ")),b(n," "),pe(i)]," ")},FieldDefinition:{leave:({description:t,name:e,arguments:r,type:n,directives:i})=>j("",t,`
`)+e+(wi(r)?j(`(
`,Ht(b(r,`
`)),`
)`):j("(",b(r,", "),")"))+": "+n+j(" ",b(i," "))},InputValueDefinition:{leave:({description:t,name:e,type:r,defaultValue:n,directives:i})=>j("",t,`
`)+b([e+": "+r,j("= ",n),b(i," ")]," ")},InterfaceTypeDefinition:{leave:({description:t,name:e,interfaces:r,directives:n,fields:i})=>j("",t,`
`)+b(["interface",e,j("implements ",b(r," & ")),b(n," "),pe(i)]," ")},UnionTypeDefinition:{leave:({description:t,name:e,directives:r,types:n})=>j("",t,`
`)+b(["union",e,b(r," "),j("= ",b(n," | "))]," ")},EnumTypeDefinition:{leave:({description:t,name:e,directives:r,values:n})=>j("",t,`
`)+b(["enum",e,b(r," "),pe(n)]," ")},EnumValueDefinition:{leave:({description:t,name:e,directives:r})=>j("",t,`
`)+b([e,b(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:t,name:e,directives:r,fields:n})=>j("",t,`
`)+b(["input",e,b(r," "),pe(n)]," ")},DirectiveDefinition:{leave:({description:t,name:e,arguments:r,repeatable:n,locations:i})=>j("",t,`
`)+"directive @"+e+(wi(r)?j(`(
`,Ht(b(r,`
`)),`
)`):j("(",b(r,", "),")"))+(n?" repeatable":"")+" on "+b(i," | ")},SchemaExtension:{leave:({directives:t,operationTypes:e})=>b(["extend schema",b(t," "),pe(e)]," ")},ScalarTypeExtension:{leave:({name:t,directives:e})=>b(["extend scalar",t,b(e," ")]," ")},ObjectTypeExtension:{leave:({name:t,interfaces:e,directives:r,fields:n})=>b(["extend type",t,j("implements ",b(e," & ")),b(r," "),pe(n)]," ")},InterfaceTypeExtension:{leave:({name:t,interfaces:e,directives:r,fields:n})=>b(["extend interface",t,j("implements ",b(e," & ")),b(r," "),pe(n)]," ")},UnionTypeExtension:{leave:({name:t,directives:e,types:r})=>b(["extend union",t,b(e," "),j("= ",b(r," | "))]," ")},EnumTypeExtension:{leave:({name:t,directives:e,values:r})=>b(["extend enum",t,b(e," "),pe(r)]," ")},InputObjectTypeExtension:{leave:({name:t,directives:e,fields:r})=>b(["extend input",t,b(e," "),pe(r)]," ")}};function b(t,e=""){var r;return(r=t==null?void 0:t.filter(n=>n).join(e))!==null&&r!==void 0?r:""}function pe(t){return j(`{
`,Ht(b(t,`
`)),`
}`)}function j(t,e,r=""){return e!=null&&e!==""?t+e+r:""}function Ht(t){return j("  ",t.replace(/\n/g,`
  `))}function wi(t){var e;return(e=t==null?void 0:t.some(r=>r.includes(`
`)))!==null&&e!==void 0?e:!1}function ya(t,e,r){return t.document?t:{document:t,variables:e,config:r}}function xi(t){var e;let r;const n=t.definitions.filter(i=>i.kind==="OperationDefinition");return n.length===1&&(r=(e=n[0].name)==null?void 0:e.value),r}function ga(t){if(typeof t=="string"){let r;try{const n=sa(t);r=xi(n)}catch{}return{query:t,operationName:r}}const e=xi(t);return{query:pa(t),operationName:e}}let Ea=class{constructor(e){this.headers={},this.isAccessTokenValidOrNull=()=>{if(!this.accessToken)return!0;try{const i=zt(this.accessToken);return i.exp!=null&&i.exp*1e3>Date.now()}catch(i){return console.error("Error decoding token:",i),!1}},this.awaitForValidAccessTokenOrNull=async()=>{if(this.isAccessTokenValidOrNull())return!0;const i=()=>this.isAccessTokenValidOrNull()?Promise.resolve(!0):new Promise(s=>{setTimeout(()=>i().then(s),100)});return i()};const{url:r,adminSecret:n}=e;this._url=r,this.accessToken=null,this.adminSecret=n}async request(e,...r){const[n,i]=r,s=ya(e,n,i),{headers:o,...d}=i||{},{query:u,operationName:l}=ga(s.document);typeof process!="undefined"&&!process.env.TEST_MODE&&await this.awaitForValidAccessTokenOrNull();try{const a=await ai(this.httpUrl,{method:"POST",body:JSON.stringify({operationName:l,query:u,variables:n}),headers:{"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...this.headers,...o},...d});if(!a.ok)return{data:null,error:{error:a.statusText,message:a.statusText,status:a.status}};const{data:c,errors:h}=await a.json();return h?{data:null,error:h}:typeof c!="object"||Array.isArray(c)||c===null?{data:null,error:{error:"invalid-response",message:"incorrect response data from GraphQL server",status:0}}:{data:c,error:null}}catch(a){const c=a;return{data:null,error:{message:c.message,status:c.name==="AbortError"?0:500,error:c.name==="AbortError"?"abort-error":"unknown"}}}}get httpUrl(){return this._url}get wsUrl(){return this._url.replace(/^(http)(s?):\/\//,"ws$2://")}get url(){return this._url}getUrl(){return this._url}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){const e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}};const Ta=/^((?<protocol>http[s]?):\/\/)?(?<host>(localhost|local))(:(?<port>(\d+|__\w+__)))?$/;function Yt(t,e){const{subdomain:r,region:n}=t;if(!r)throw new Error("A `subdomain` must be set.");const i=r.match(Ta);if(i!=null&&i.groups){const{protocol:s,host:o,port:d}=i.groups;return xa(e)||(o==="localhost"?(console.warn('The `subdomain` is set to "localhost". Support for this will be removed in a future release. Please use "local" instead.'),`${s||"http"}://localhost:${d||1337}/v1/${e}`):d?`${s||"https"}://local.${e}.nhost.run:${d}/v1`:`${s||"https"}://local.${e}.nhost.run/v1`)}if(!n)throw new Error('`region` must be set when using a `subdomain` other than "local".');return`https://${r}.${e}.${n}.nhost.run/v1`}function Sa(){return typeof window!="undefined"}function wa(){return typeof process!="undefined"&&process.env}function xa(t){return Sa()||!wa()?null:process.env[`NHOST_${t.toUpperCase()}_URL`]}function Aa(t,e){const r=e.startsWith("/")?e:`/${e}`;return t+r}function Oa(t){const e="subdomain"in t?Yt(t,"auth"):t.authUrl;if(!e)throw new Error("Please provide `subdomain` or `authUrl`.");return new To({url:e,...t})}function ba(t){const e="subdomain"in t?Yt(t,"functions"):t.functionsUrl;if(!e)throw new Error("Please provide `subdomain` or `functionsUrl`.");return new ka({url:e,...t})}class ka{constructor(e){this.headers={};const{url:r,adminSecret:n}=e;this.url=r,this.accessToken=null,this.adminSecret=n}async call(e,r,n){var i,s;const o={"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...n==null?void 0:n.headers,...this.headers},d=Aa(this.url,e);try{const u=await ai(d,{body:r?JSON.stringify(r):null,headers:o,method:"POST"});if(!u.ok){let a;return(i=u.headers.get("content-type"))!=null&&i.includes("application/json")?a=await u.json():a=await u.text(),{res:null,error:{message:a,error:u.statusText,status:u.status}}}let l;return(s=u.headers.get("content-type"))!=null&&s.includes("application/json")?l=await u.json():l=await u.text(),{res:{data:l,status:u.status,statusText:u.statusText},error:null}}catch(u){const l=u;return{res:null,error:{message:l.message,status:l.name==="AbortError"?0:500,error:l.name==="AbortError"?"abort-error":"unknown"}}}}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){const e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}function Ia(t){const e="subdomain"in t?Yt(t,"graphql"):t.graphqlUrl;if(!e)throw new Error("Please provide `subdomain` or `graphqlUrl`.");return new Ea({url:e,...t})}function _a(t){const e="subdomain"in t?Yt(t,"storage"):t.storageUrl;if(!e)throw new Error("Please provide `subdomain` or `storageUrl`.");return new xo({url:e,...t})}class Na{constructor({refreshIntervalTime:e,clientStorage:r,clientStorageType:n,autoRefreshToken:i,autoSignIn:s,adminSecret:o,devTools:d,start:u=!0,...l}){this.auth=Oa({refreshIntervalTime:e,clientStorage:r,clientStorageType:n,autoRefreshToken:i,autoSignIn:s,start:u,...l}),this.storage=_a({adminSecret:o,...l}),this.functions=ba({adminSecret:o,...l}),this.graphql=Ia({adminSecret:o,...l}),this.auth.onAuthStateChanged((a,c)=>{if(a==="SIGNED_OUT"){this.storage.setAccessToken(void 0),this.functions.setAccessToken(void 0),this.graphql.setAccessToken(void 0);return}const h=c==null?void 0:c.accessToken;this.storage.setAccessToken(h),this.functions.setAccessToken(h),this.graphql.setAccessToken(h)}),this.auth.onTokenChanged(a=>{const c=a==null?void 0:a.accessToken;this.storage.setAccessToken(c),this.functions.setAccessToken(c),this.graphql.setAccessToken(c)}),this._adminSecret=o,this.devTools=d}get adminSecret(){return this._adminSecret}set adminSecret(e){this._adminSecret=e,this.storage.setAdminSecret(e)}setRole(e){this.graphql.setHeaders({"x-hasura-role":e}),this.storage.setHeaders({"x-hasura-role":e}),this.functions.setHeaders({"x-hasura-role":e})}unsetRole(){this.graphql.setHeaders((({"x-hasura-role":e,...r})=>r)(this.graphql.getHeaders())),this.storage.setHeaders((({"x-hasura-role":e,...r})=>r)(this.storage.getHeaders())),this.functions.setHeaders((({"x-hasura-role":e,...r})=>r)(this.functions.getHeaders()))}}const Ai=Na;class Ra extends Ai{constructor(e){super({...e,start:!1})}}var Mr={exports:{}},jr={},Kt={exports:{}},Fr={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oi;function Da(){if(Oi)return Fr;Oi=1;var t=L;function e(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function d(c,h){var f=h(),p=n({inst:{value:f,getSnapshot:h}}),m=p[0].inst,O=p[1];return s(function(){m.value=f,m.getSnapshot=h,u(m)&&O({inst:m})},[c,f,h]),i(function(){return u(m)&&O({inst:m}),c(function(){u(m)&&O({inst:m})})},[c]),o(f),f}function u(c){var h=c.getSnapshot;c=c.value;try{var f=h();return!r(c,f)}catch{return!0}}function l(c,h){return h()}var a=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?l:d;return Fr.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:a,Fr}var Vr={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bi;function Ca(){return bi||(bi=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var t=L,e=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function r(w){{for(var x=arguments.length,P=new Array(x>1?x-1:0),k=1;k<x;k++)P[k-1]=arguments[k];n("error",w,P)}}function n(w,x,P){{var k=e.ReactDebugCurrentFrame,I=k.getStackAddendum();I!==""&&(x+="%s",P=P.concat([I]));var U=P.map(function(R){return String(R)});U.unshift("Warning: "+x),Function.prototype.apply.call(console[w],console,U)}}function i(w,x){return w===x&&(w!==0||1/w===1/x)||w!==w&&x!==x}var s=typeof Object.is=="function"?Object.is:i,o=t.useState,d=t.useEffect,u=t.useLayoutEffect,l=t.useDebugValue,a=!1,c=!1;function h(w,x,P){a||t.startTransition!==void 0&&(a=!0,r("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var k=x();if(!c){var I=x();s(k,I)||(r("The result of getSnapshot should be cached to avoid an infinite loop"),c=!0)}var U=o({inst:{value:k,getSnapshot:x}}),R=U[0].inst,z=U[1];return u(function(){R.value=k,R.getSnapshot=x,f(R)&&z({inst:R})},[w,k,x]),d(function(){f(R)&&z({inst:R});var N=function(){f(R)&&z({inst:R})};return w(N)},[w]),l(k),k}function f(w){var x=w.getSnapshot,P=w.value;try{var k=x();return!s(P,k)}catch{return!0}}function p(w,x,P){return x()}var m=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",O=!m,E=O?p:h,A=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:E;Vr.useSyncExternalStore=A,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Vr}var ki;function Ii(){return ki||(ki=1,process.env.NODE_ENV==="production"?Kt.exports=Da():Kt.exports=Ca()),Kt.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _i;function Pa(){if(_i)return jr;_i=1;var t=L,e=Ii();function r(l,a){return l===a&&(l!==0||1/l===1/a)||l!==l&&a!==a}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,d=t.useMemo,u=t.useDebugValue;return jr.useSyncExternalStoreWithSelector=function(l,a,c,h,f){var p=s(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=d(function(){function E(k){if(!A){if(A=!0,w=k,k=h(k),f!==void 0&&m.hasValue){var I=m.value;if(f(I,k))return x=I}return x=k}if(I=x,n(w,k))return I;var U=h(k);return f!==void 0&&f(I,U)?I:(w=k,x=U)}var A=!1,w,x,P=c===void 0?null:c;return[function(){return E(a())},P===null?void 0:function(){return E(P())}]},[a,c,h,f]);var O=i(l,p[0],p[1]);return o(function(){m.hasValue=!0,m.value=O},[O]),u(O),O},jr}var Br={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ni;function La(){return Ni||(Ni=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var t=L,e=Ii();function r(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,d=t.useMemo,u=t.useDebugValue;function l(a,c,h,f,p){var m=s(null),O;m.current===null?(O={hasValue:!1,value:null},m.current=O):O=m.current;var E=d(function(){var P=!1,k,I,U=function(V){if(!P){P=!0,k=V;var Q=f(V);if(p!==void 0&&O.hasValue){var $=O.value;if(p($,Q))return I=$,$}return I=Q,Q}var we=k,ve=I;if(n(we,V))return ve;var v=f(V);return p!==void 0&&p(ve,v)?ve:(k=V,I=v,v)},R=h===void 0?null:h,z=function(){return U(c())},N=R===null?void 0:function(){return U(R())};return[z,N]},[c,h,f,p]),A=E[0],w=E[1],x=i(a,A,w);return o(function(){O.hasValue=!0,O.value=x},[x]),u(x),x}Br.useSyncExternalStoreWithSelector=l,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Br}process.env.NODE_ENV==="production"?Mr.exports=Pa():Mr.exports=La();var Ua=Mr.exports,Ma=L.useLayoutEffect;function Ri(t){var e=Fi.useRef();return e.current||(e.current={v:t()}),e.current.v}var qt=function(){return qt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},qt.apply(this,arguments)},ja=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Di=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(d){o={error:d}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s};function Fa(t,e){var r=Ri(function(){return typeof t=="function"?t():t});if(process.env.NODE_ENV!=="production"&&typeof t!="function"){var n=Di(L.useState(r),1),i=n[0];t!==i&&console.warn("Machine given to `useMachine` has changed between renders. This is not supported and might lead to unexpected results.\nPlease make sure that you pass the same Machine as argument each time.")}var s=e.context,o=e.guards,d=e.actions,u=e.activities,l=e.services,a=e.delays;e.state;var c=ja(e,["context","guards","actions","activities","services","delays","state"]),h=Ri(function(){var f={context:s,guards:o,actions:d,activities:u,services:l,delays:a},p=r.withConfig(f,function(){return qt(qt({},r.context),s)});return De(p,c)});return Ma(function(){Object.assign(h.machine.options.actions,d),Object.assign(h.machine.options.guards,o),Object.assign(h.machine.options.activities,u),Object.assign(h.machine.options.services,l),Object.assign(h.machine.options.delays,a)},[d,o,u,l,a]),h}function _e(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Di(e,2),i=n[0],s=i===void 0?{}:i,o=n[1],d=Fa(t,s);return L.useEffect(function(){if(o){var u=d.subscribe(Xe(o));return function(){u.unsubscribe()}}},[o]),L.useEffect(function(){var u=s.state;return d.start(u?he.create(u):void 0),function(){d.stop(),d.status=te.NotStarted}},[]),d}function Va(t){return t.status!==0?t.getSnapshot():t.machine.initialState}function Ba(t){return"state"in t&&"machine"in t}function Ga(t){return"state"in t}var Ha=function(t,e){return t===e},Ya=function(t,e){if(Ba(t)){if(t.status===0&&e.current)return e.current;var r=Va(t);return e.current=t.status===0?r:null,r}return Ga(t)?t.state:void 0};function g(t,e,r,n){r===void 0&&(r=Ha);var i=L.useRef(null),s=L.useCallback(function(u){var l=t.subscribe(u).unsubscribe;return l},[t]),o=L.useCallback(function(){return Ya(t,i)},[t,n]),d=Ua.useSyncExternalStoreWithSelector(s,o,o,e,r);return d}const dt=L.createContext({}),Ci=({nhost:t,initial:e,...r})=>{const n=_e(t.auth.client.machine,{devTools:t.devTools});t.auth.client.start({interpreter:n,initialSession:e,devTools:t.devTools});const i=L.useRef(!0);return L.useEffect(()=>{i.current?i.current=!1:e&&n.send("SESSION_UPDATE",{data:{session:e}})},[e,n]),Mi.jsx(dt.Provider,{value:t,children:r.children})},Ka=Ci,ee=()=>{var r;const e=(r=L.useContext(dt).auth)==null?void 0:r.client.interpreter;if(!e)throw Error("Could not find the Nhost auth client. Did you wrap your app in <NhostProvider />?");return e},Gr=()=>{const t=ee();return g(t,e=>({isAuthenticated:e.matches({authentication:"signedIn"}),isLoading:e.hasTag("loading"),error:e.context.errors.authentication||null,isError:e.matches({authentication:{signedOut:"failed"}}),connectionAttempts:e.context.importTokenAttempts}),(e,r)=>e.isAuthenticated===r.isAuthenticated&&e.isLoading===r.isLoading&&e.connectionAttempts===r.connectionAttempts)};function qa({children:t}){const{isAuthenticated:e}=Gr();return e?L.createElement(L.Fragment,null,t):null}function $a({children:t}){const{isAuthenticated:e}=Gr();return e?null:L.createElement(L.Fragment,null,t)}const Hr=()=>{const t=ee();return g(t,e=>e.context.accessToken.value)},ge=()=>L.useContext(dt),za=()=>{const t=ge(),[e,r]=L.useState(null),n=!e,i=!!e,[s,o]=L.useState(!1);return{add:async u=>{o(!0);const l=await Kn(t.auth.client,u),{error:a}=l;return a&&r(a),o(!1),l},isLoading:s,isSuccess:n,isError:i,error:e}},Ja=()=>{const t=ee(),[e,r]=L.useState(!!t.status&&t.getSnapshot().matches({authentication:"signedIn"}));return L.useEffect(()=>t.subscribe(i=>{const s=i.matches({authentication:"signedIn"});r(s)}).unsubscribe,[t]),e};function Wa(t){const e=ge(),r=L.useMemo(()=>Bn(e.auth.client),[e]),n=_e(r),i=g(n,l=>l.matches("requesting")),s=g(n,l=>l.context.error),o=g(n,l=>l.matches("idle.error")),d=g(n,l=>l.matches("idle.success"));return{changeEmail:L.useCallback(async(l,a=t)=>qn(n,l,a),[n,t]),isLoading:i,needsEmailVerification:d,isError:o,error:s}}const Qa=()=>{const t=ge(),e=L.useMemo(()=>Gn(t.auth.client),[t]),r=_e(e),n=g(r,u=>u.matches({idle:"error"})),i=g(r,u=>u.matches({idle:"success"})),s=g(r,u=>u.context.error),o=g(r,u=>u.matches("requesting"));return{changePassword:u=>$n(r,u),isLoading:o,isSuccess:i,isError:n,error:s}},Xa=()=>{const t=ge(),e=L.useMemo(()=>vo(t.auth.client),[t]),r=_e(e),n=g(r,h=>h.matches({idle:"error"})||h.matches({generated:{idle:"error"}})),i=g(r,h=>h.matches("generating")),s=g(r,h=>h.matches("generated")),o=g(r,h=>h.matches({generated:"activating"})),d=g(r,h=>h.matches({generated:"activated"})),u=g(r,h=>h.context.error),l=g(r,h=>h.context.imageUrl||"");return{generateQrCode:()=>yo(r),isGenerating:i,qrCodeDataUrl:l,isGenerated:s,activateMfa:h=>go(r,h),isActivating:o,isActivated:d,isError:n,error:u}},Pi=()=>{const t=Hr();return t?zt(t):null},Li=t=>{const e=ge(),r=p=>{t.send({type:"ADD",file:p.file,bucketId:p.bucketId||h})},n=p=>Oo({url:e.storage.url,accessToken:e.auth.getAccessToken(),adminSecret:e.adminSecret,...p},t),i=()=>{t.send("CANCEL")},s=()=>{t.send("DESTROY")},o=g(t,p=>p.matches("uploading")),d=g(t,p=>p.matches("uploaded")),u=g(t,p=>p.matches("error")),l=g(t,p=>p.context.error||null),a=g(t,p=>p.context.progress),c=g(t,p=>p.context.id),h=g(t,p=>p.context.bucketId),f=g(t,p=>{var m;return(m=p.context.file)==null?void 0:m.name});return{add:r,upload:n,cancel:i,destroy:s,isUploaded:d,isUploading:o,isError:u,error:l,progress:a,id:c,bucketId:h,name:f}},Za=()=>{const t=_e(si);return Li(t)},Yr=()=>{const t=Pi();return(t==null?void 0:t["https://hasura.io/jwt/claims"])||null},ec=t=>{const e=Yr();return(e==null?void 0:e[t.startsWith("x-hasura-")?t:`x-hasura-${t}`])||null},tc=()=>{const t=ge(),[e,r]=L.useState([]),n=_e(Ao,{},f=>{f.event.type==="UPLOAD_ERROR"?r(f.context.files.filter(p=>{var m;return(m=p.getSnapshot())==null?void 0:m.context.error})):(f.matches("uploaded")||f.event.type==="CLEAR")&&e.length>0&&r([])}),i=f=>{n.send({type:"ADD",...f})},s=f=>bo({url:t.storage.url,accessToken:t.auth.getAccessToken(),adminSecret:t.adminSecret,...f},n),o=()=>{n.send("CANCEL")},d=()=>{n.send("CLEAR")},u=g(n,f=>f.matches("uploading")),l=g(n,f=>f.matches("uploaded")),a=g(n,f=>f.matches("error")),c=g(n,f=>f.context.progress),h=g(n,f=>f.context.files);return{upload:s,add:i,clear:d,cancel:o,progress:c,isUploaded:l,isUploading:u,files:h,isError:a,errors:e}},rc=t=>{const[e,r]=L.useState(!0),n=Hr();L.useEffect(()=>{r(!1)},[]);const i=L.useContext(dt);return new Proxy({},{get(s,o){let d=`${i.auth.client.backendUrl}/signin/provider/${o}`;const u=t!=null&&t.connect?{connect:n}:{};return Ut(d,le(e?void 0:i.auth.client.clientUrl,{...t,...u}))}})},nc=t=>{const e=ge(),r=L.useMemo(()=>Hn(e.auth.client),[e]),n=_e(r),i=g(n,l=>l.matches("requesting")),s=g(n,l=>l.context.error),o=g(n,l=>l.matches("idle.error")),d=g(n,l=>l.matches("idle.success"));return{resetPassword:(l,a=t)=>zn(n,l,a),isLoading:i,isSent:d,isError:o,error:s}},ic=t=>{const e=ge(),r=L.useMemo(()=>Yn(e.auth.client),[e]),n=_e(r),i=g(n,l=>l.matches({idle:"error"})),s=g(n,l=>l.matches({idle:"success"})),o=g(n,l=>l.context.error),d=g(n,l=>l.matches("requesting"));return{sendEmail:(l,a=t)=>Jn(n,l,a),isLoading:d,isSent:s,isError:i,error:o}},sc=()=>{const t=ee(),e=()=>Wn(t),r=g(t,u=>u.context.errors.authentication||null,(u,l)=>(u==null?void 0:u.error)===(l==null?void 0:l.error)),n=g(t,u=>u.matches({authentication:{authenticating:"anonymous"}})),i=g(t,u=>u.matches({authentication:"signedIn"})),s=g(t,u=>u.matches({authentication:{signedOut:"failed"}})),o=g(t,u=>u.context.user,(u,l)=>(u==null?void 0:u.id)===(l==null?void 0:l.id));return{accessToken:g(t,u=>u.context.accessToken.value),error:r,isError:s,isLoading:n,isSuccess:i,signInAnonymous:e,user:o}},oc=()=>{const t=ee(),e=(f,p)=>Qn(t,f,p),r=f=>ei(t,f),n=g(t,f=>f.context.user,(f,p)=>(f==null?void 0:f.id)===(p==null?void 0:p.id)),i=g(t,f=>f.context.accessToken.value),s=g(t,f=>f.context.refreshToken.value),o=g(t,f=>f.context.errors.authentication||null,(f,p)=>(f==null?void 0:f.error)===(p==null?void 0:p.error)),d=g(t,f=>f.matches({authentication:"signedIn"})),u=g(t,f=>f.matches({authentication:{authenticating:"password"}}),(f,p)=>f===p),l=g(t,f=>f.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(f,p)=>f===p),a=g(t,f=>f.matches({authentication:{signedOut:"needsMfa"}}),(f,p)=>f===p),c=g(t,f=>f.matches({authentication:{signedOut:"failed"}}),(f,p)=>f===p),h=g(t,f=>f.context.mfa);return{accessToken:i,refreshToken:s,error:o,isError:c,isLoading:u,isSuccess:d,needsEmailVerification:l,needsMfaOtp:a,mfa:h,sendMfaOtp:r,signInEmailPassword:e,user:n}};function ac(t){const e=ee(),r=(d,u=t)=>Sr(e,d,u),n=g(e,d=>d.context.errors.registration||null,(d,u)=>(d==null?void 0:d.error)===(u==null?void 0:u.error)),i=g(e,d=>d.matches("registration.passwordlessEmail")),s=g(e,d=>d.matches("registration.incomplete.needsEmailVerification")),o=g(e,d=>d.matches("registration.incomplete.failed"));return{signInEmailPasswordless:r,isLoading:i,isSuccess:s,isError:o,error:n}}const cc=()=>{const t=ee(),e=a=>Xn(t,a),r=g(t,a=>a.context.user,(a,c)=>(a==null?void 0:a.id)===(c==null?void 0:c.id)),n=g(t,a=>a.context.accessToken.value),i=g(t,a=>a.context.refreshToken.value),s=g(t,a=>a.context.errors.authentication||null,(a,c)=>(a==null?void 0:a.error)===(c==null?void 0:c.error)),o=g(t,a=>a.matches({authentication:"signedIn"})),d=g(t,a=>a.matches({authentication:{authenticating:"securityKeyEmail"}}),(a,c)=>a===c),u=g(t,a=>a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(a,c)=>a===c),l=g(t,a=>a.matches({authentication:{signedOut:"failed"}}),(a,c)=>a===c);return{accessToken:n,refreshToken:i,error:s,isError:l,isLoading:d,isSuccess:o,needsEmailVerification:u,signInEmailSecurityKey:e,user:r}},Ui=()=>{const t=ee();return g(t,e=>e.context.user,(e,r)=>(e&&JSON.stringify(e))===(r&&JSON.stringify(r)))},uc=()=>{const t=Ui(),e=ge(),r=Yr(),n=t?(r==null?void 0:r["x-hasura-auth-elevated"])===(t==null?void 0:t.id):!1,[i,s]=L.useState(!!n),o=d=>Zn(e.auth.client,d);return L.useEffect(()=>{s(!!n)},[n]),{elevated:i,elevateEmailSecurityKey:o}},lc=()=>{const t=ee(),e=l=>ti(t,l),r=g(t,l=>l.context.user,(l,a)=>(l==null?void 0:l.id)===(a==null?void 0:a.id)),n=g(t,l=>l.context.accessToken.value),i=g(t,l=>l.context.refreshToken.value),s=g(t,l=>l.context.errors.authentication||null,(l,a)=>(l==null?void 0:l.error)===(a==null?void 0:a.error)),o=g(t,l=>l.matches({authentication:"signedIn"})),d=g(t,l=>l.matches({authentication:{authenticating:"password"}}),(l,a)=>l===a),u=g(t,l=>l.matches({authentication:{signedOut:"failed"}}),(l,a)=>l===a);return{accessToken:n,refreshToken:i,error:s,isError:u,isLoading:d,isSuccess:o,signInPAT:e,user:r}};function dc(t){const e=ee(),[r,n]=L.useState(""),i=(c,h=t)=>(n(c),wr(e,c,h)),s=async(...c)=>{if(c.length===2){const[f,p]=c;return xr(e,f,p)}const[h]=c;return xr(e,r,h)},o=g(e,c=>c.context.errors.registration||null,(c,h)=>(c==null?void 0:c.error)===(h==null?void 0:h.error)),d=g(e,c=>c.matches("registration.passwordlessSms")||c.matches("registration.passwordlessSmsOtp")),u=g(e,c=>c.matches("authentication.signedIn")),l=g(e,c=>c.matches("registration.incomplete.needsOtp")),a=g(e,c=>c.matches("registration.incomplete.failed"));return{signInSmsPasswordless:i,sendOtp:s,isLoading:d,isSuccess:u,needsOtp:l,isError:a,error:o}}const hc=(t=!1)=>{const e=ee(),r=s=>ri(e,typeof s=="boolean"?s:t),n=g(e,s=>s.matches({authentication:{signedOut:"success"}}),(s,o)=>s===o),i=g(e,s=>s.context.errors.signout||null,(s,o)=>(s==null?void 0:s.error)===(o==null?void 0:o.error));return{signOut:r,isSuccess:n,error:i}},fc=t=>{const e=ee(),r=g(e,c=>!!c.context.errors.registration),n=g(e,c=>c.context.errors.registration||null,(c,h)=>(c==null?void 0:c.error)===(h==null?void 0:h.error)),i=g(e,c=>c.matches("registration.emailPassword")),s=g(e,c=>c.matches("registration.incomplete.needsEmailVerification")),o=g(e,c=>c.matches({authentication:"signedIn",registration:"complete"})),d=(c,h,f=t)=>Ar(e,c,h,f),u=g(e,c=>c.context.user,(c,h)=>(c==null?void 0:c.id)===(h==null?void 0:h.id)),l=g(e,c=>c.context.accessToken.value),a=g(e,c=>c.context.refreshToken.value);return{accessToken:l,refreshToken:a,error:n,isError:r,isLoading:i,isSuccess:o,needsEmailVerification:s,signUpEmailPassword:d,user:u}},pc=t=>{const e=ee(),r=g(e,c=>!!c.context.errors.registration),n=g(e,c=>c.context.errors.registration||null,(c,h)=>(c==null?void 0:c.error)===(h==null?void 0:h.error)),i=g(e,c=>c.matches("registration.securityKey")),s=g(e,c=>c.matches("registration.incomplete.needsEmailVerification")),o=g(e,c=>c.matches({authentication:"signedIn",registration:"complete"})),d=(c,h=t)=>ni(e,c,h),u=g(e,c=>c.context.user,(c,h)=>(c==null?void 0:c.id)===(h==null?void 0:h.id)),l=g(e,c=>c.context.accessToken.value),a=g(e,c=>c.context.refreshToken.value);return{accessToken:l,refreshToken:a,error:n,isError:r,isLoading:i,isSuccess:o,needsEmailVerification:s,signUpEmailSecurityKey:d,user:u}},vc=()=>{const t=ee();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.avatarUrl},(e,r)=>e===r)},mc=()=>{const t=ee();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.defaultRole},(e,r)=>e===r)},yc=()=>{const t=ee();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.displayName},(e,r)=>e===r)},gc=()=>{const t=ee();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.email},(e,r)=>e===r)},Ec=()=>{const t=ee();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.id},(e,r)=>e===r)},Tc=()=>{const t=ee();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.isAnonymous},(e,r)=>e===r)},Sc=()=>{const t=ee();return g(t,e=>{var r;return(r=e.context.user)==null?void 0:r.locale},(e,r)=>e===r)},wc=()=>{const t=ee();return g(t,e=>{var r;return e.matches("authentication.signedIn")?((r=e.context.user)==null?void 0:r.roles)||[]:[]})};_.NHOST_REFRESH_TOKEN_KEY=He,_.NhostClient=Ra,_.NhostProvider=Ci,_.NhostReactContext=dt,_.NhostReactProvider=Ka,_.SignedIn=qa,_.SignedOut=$a,_.VanillaNhostClient=Ai,_.useAccessToken=Hr,_.useAddSecurityKey=za,_.useAuthInterpreter=ee,_.useAuthenticated=Ja,_.useAuthenticationStatus=Gr,_.useChangeEmail=Wa,_.useChangePassword=Qa,_.useConfigMfa=Xa,_.useDecodedAccessToken=Pi,_.useElevateSecurityKeyEmail=uc,_.useFileUpload=Za,_.useFileUploadItem=Li,_.useHasuraClaim=ec,_.useHasuraClaims=Yr,_.useMultipleFilesUpload=tc,_.useNhostClient=ge,_.useProviderLink=rc,_.useResetPassword=nc,_.useSendVerificationEmail=ic,_.useSignInAnonymous=sc,_.useSignInEmailPassword=oc,_.useSignInEmailPasswordless=ac,_.useSignInEmailSecurityKey=cc,_.useSignInPAT=lc,_.useSignInSmsPasswordless=dc,_.useSignOut=hc,_.useSignUpEmailPassword=fc,_.useSignUpEmailSecurityKeyEmail=pc,_.useUserAvatarUrl=vc,_.useUserData=Ui,_.useUserDefaultRole=mc,_.useUserDisplayName=yc,_.useUserEmail=gc,_.useUserId=Ec,_.useUserIsAnonymous=Tc,_.useUserLocale=Sc,_.useUserRoles=wc,Object.defineProperty(_,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=react.umd.js.map
